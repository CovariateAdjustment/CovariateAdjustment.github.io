<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Applying Covariate Adjustment: ANCOVA &amp; G-Computation | Covariate Adjustment in Randomized Trials</title>
  <meta name="description" content="<p>This a series of tutorials meant to help investigators apply covariate
adjusted analyses in randomized trials.</p>" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Applying Covariate Adjustment: ANCOVA &amp; G-Computation | Covariate Adjustment in Randomized Trials" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This a series of tutorials meant to help investigators apply covariate
adjusted analyses in randomized trials.</p>" />
  <meta name="github-repo" content="covariateadjustment/covariateadjustment.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Applying Covariate Adjustment: ANCOVA &amp; G-Computation | Covariate Adjustment in Randomized Trials" />
  
  <meta name="twitter:description" content="<p>This a series of tutorials meant to help investigators apply covariate
adjusted analyses in randomized trials.</p>" />
  

<meta name="author" content="Josh Betz, Kelly van Lancker, and Michael Rosenblum" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="using_r.html"/>
<link rel="next" href="doublyrobust.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/table1-1.0/table1_defaults.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Covariate Adjustment in Randomized Trials</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Covariate Adjustment: Opportunities and Challenges</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#using-this-book"><i class="fa fa-check"></i><b>1.1</b> Using this Book</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#case-studies"><i class="fa fa-check"></i><b>1.2</b> Case Studies</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#ctn_03"><i class="fa fa-check"></i><b>1.2.1</b> Buprenorphine tapering schedule and illicit opioid use: CTN-03</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#mistie_iii"><i class="fa fa-check"></i><b>1.2.2</b> Functional Outcome in Hemorrhagic Stroke: MISTIE III</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#notation"><i class="fa fa-check"></i><b>2.1</b> Notation and Assumptions</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#ancova"><i class="fa fa-check"></i><b>2.2</b> The Analysis of Covariance (ANCOVA)</a></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#generalizing-the-ancova-g-computation"><i class="fa fa-check"></i><b>2.3</b> Generalizing the ANCOVA: G-computation</a></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#combining-covariate-adjustment-and-stratified-randomization"><i class="fa fa-check"></i><b>2.4</b> Combining Covariate Adjustment and Stratified Randomization</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="estimands.html"><a href="estimands.html"><i class="fa fa-check"></i><b>3</b> Targets of Inference: Estimands</a>
<ul>
<li class="chapter" data-level="3.1" data-path="estimands.html"><a href="estimands.html#estimands-for-continuous-and-binary-outcomes"><i class="fa fa-check"></i><b>3.1</b> Estimands for Continuous and Binary Outcomes</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="estimands.html"><a href="estimands.html#difference-in-means"><i class="fa fa-check"></i><b>3.1.1</b> Difference in Means</a></li>
<li class="chapter" data-level="3.1.2" data-path="estimands.html"><a href="estimands.html#ratio-of-means"><i class="fa fa-check"></i><b>3.1.2</b> Ratio of Means</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="estimands.html"><a href="estimands.html#ordinal_estimands"><i class="fa fa-check"></i><b>3.2</b> Estimands for Ordinal Outcomes</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="estimands.html"><a href="estimands.html#difference-in-mean-utility"><i class="fa fa-check"></i><b>3.2.1</b> Difference in Mean Utility</a></li>
<li class="chapter" data-level="3.2.2" data-path="estimands.html"><a href="estimands.html#mann-whitney-m-w-estimand"><i class="fa fa-check"></i><b>3.2.2</b> Mann-Whitney (M-W) Estimand</a></li>
<li class="chapter" data-level="3.2.3" data-path="estimands.html"><a href="estimands.html#log-odds-ratio-lor"><i class="fa fa-check"></i><b>3.2.3</b> Log Odds Ratio (LOR)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="estimands.html"><a href="estimands.html#survival_estimands"><i class="fa fa-check"></i><b>3.3</b> Survival/Time-To-Event Outcomes</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="estimands.html"><a href="estimands.html#survival-function"><i class="fa fa-check"></i><b>3.3.1</b> Survival Function</a></li>
<li class="chapter" data-level="3.3.2" data-path="estimands.html"><a href="estimands.html#hazard_ratio"><i class="fa fa-check"></i><b>3.3.2</b> Hazard Ratio</a></li>
<li class="chapter" data-level="3.3.3" data-path="estimands.html"><a href="estimands.html#restricted-mean-survival-time"><i class="fa fa-check"></i><b>3.3.3</b> Restricted Mean Survival Time</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="using_r.html"><a href="using_r.html"><i class="fa fa-check"></i><b>4</b> Using R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="using_r.html"><a href="using_r.html#installing-packages"><i class="fa fa-check"></i><b>4.1</b> Installing Packages</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="using_r.html"><a href="using_r.html#packages-from-cran"><i class="fa fa-check"></i><b>4.1.1</b> Packages from CRAN</a></li>
<li class="chapter" data-level="4.1.2" data-path="using_r.html"><a href="using_r.html#packages-from-github"><i class="fa fa-check"></i><b>4.1.2</b> Packages from Github</a></li>
<li class="chapter" data-level="4.1.3" data-path="using_r.html"><a href="using_r.html#loading-packages-into-workspace"><i class="fa fa-check"></i><b>4.1.3</b> Loading Packages into Workspace</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="using_r.html"><a href="using_r.html#Load_MISTIE"><i class="fa fa-check"></i><b>4.2</b> Loading the Data: MISTIE-III</a></li>
<li class="chapter" data-level="4.3" data-path="using_r.html"><a href="using_r.html#assessing-baseline-balance"><i class="fa fa-check"></i><b>4.3</b> Assessing Baseline Balance</a></li>
<li class="chapter" data-level="4.4" data-path="using_r.html"><a href="using_r.html#visualizing-data"><i class="fa fa-check"></i><b>4.4</b> Visualizing Data</a></li>
<li class="chapter" data-level="4.5" data-path="using_r.html"><a href="using_r.html#fitting-regression-models"><i class="fa fa-check"></i><b>4.5</b> Fitting Regression Models</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="using_r.html"><a href="using_r.html#generalized-linear-model"><i class="fa fa-check"></i><b>4.5.1</b> Generalized Linear Model</a></li>
<li class="chapter" data-level="4.5.2" data-path="using_r.html"><a href="using_r.html#logrank-test-and-cox-proportional-hazards-model"><i class="fa fa-check"></i><b>4.5.2</b> Logrank Test and Cox Proportional Hazards Model</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="using_r.html"><a href="using_r.html#variance-estimation"><i class="fa fa-check"></i><b>4.6</b> Variance Estimation</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="using_r.html"><a href="using_r.html#robust-standard-errors"><i class="fa fa-check"></i><b>4.6.1</b> Robust Standard Errors</a></li>
<li class="chapter" data-level="4.6.2" data-path="using_r.html"><a href="using_r.html#bootstrap-estimator"><i class="fa fa-check"></i><b>4.6.2</b> Bootstrap Estimator</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="using_r.html"><a href="using_r.html#addressing-multiplicity"><i class="fa fa-check"></i><b>4.7</b> Addressing Multiplicity</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="applying-covariate-adjustment-ancova-g-computation.html"><a href="applying-covariate-adjustment-ancova-g-computation.html"><i class="fa fa-check"></i><b>5</b> Applying Covariate Adjustment: ANCOVA &amp; G-Computation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="applying-covariate-adjustment-ancova-g-computation.html"><a href="applying-covariate-adjustment-ancova-g-computation.html#computing-the-estimate"><i class="fa fa-check"></i><b>5.1</b> Computing the Estimate</a></li>
<li class="chapter" data-level="5.2" data-path="applying-covariate-adjustment-ancova-g-computation.html"><a href="applying-covariate-adjustment-ancova-g-computation.html#standard-error-inference"><i class="fa fa-check"></i><b>5.2</b> Standard Error &amp; Inference</a></li>
<li class="chapter" data-level="5.3" data-path="applying-covariate-adjustment-ancova-g-computation.html"><a href="applying-covariate-adjustment-ancova-g-computation.html#calculating-precision-gain"><i class="fa fa-check"></i><b>5.3</b> Calculating Precision Gain</a></li>
<li class="chapter" data-level="5.4" data-path="applying-covariate-adjustment-ancova-g-computation.html"><a href="applying-covariate-adjustment-ancova-g-computation.html#covariate-adjustment-with-binary-outcomes"><i class="fa fa-check"></i><b>5.4</b> Covariate Adjustment with Binary Outcomes</a></li>
<li class="chapter" data-level="5.5" data-path="applying-covariate-adjustment-ancova-g-computation.html"><a href="applying-covariate-adjustment-ancova-g-computation.html#stratified-randomization-covariate-adjustment"><i class="fa fa-check"></i><b>5.5</b> Stratified Randomization &amp; Covariate Adjustment</a></li>
<li class="chapter" data-level="5.6" data-path="applying-covariate-adjustment-ancova-g-computation.html"><a href="applying-covariate-adjustment-ancova-g-computation.html#missing-outcome-data-inverse-weighting"><i class="fa fa-check"></i><b>5.6</b> Missing Outcome Data: Inverse Weighting</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="doublyrobust.html"><a href="doublyrobust.html"><i class="fa fa-check"></i><b>6</b> Doubly Robust Estimators</a>
<ul>
<li class="chapter" data-level="6.1" data-path="doublyrobust.html"><a href="doublyrobust.html#augmented-inverse-probability-weighted-estimation"><i class="fa fa-check"></i><b>6.1</b> Augmented Inverse Probability Weighted Estimation</a></li>
<li class="chapter" data-level="6.2" data-path="doublyrobust.html"><a href="doublyrobust.html#targeted-maximum-likelihood-estimation"><i class="fa fa-check"></i><b>6.2</b> Targeted Maximum Likelihood Estimation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="timetoevent.html"><a href="timetoevent.html"><i class="fa fa-check"></i><b>7</b> Time-To-Event Outcomes</a>
<ul>
<li class="chapter" data-level="7.1" data-path="timetoevent.html"><a href="timetoevent.html#unadjusted-estimators"><i class="fa fa-check"></i><b>7.1</b> Unadjusted Estimators</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="timetoevent.html"><a href="timetoevent.html#kaplan-meier-estimator"><i class="fa fa-check"></i><b>7.1.1</b> Kaplan-Meier Estimator</a></li>
<li class="chapter" data-level="7.1.2" data-path="timetoevent.html"><a href="timetoevent.html#logrank-test"><i class="fa fa-check"></i><b>7.1.2</b> Logrank Test</a></li>
<li class="chapter" data-level="7.1.3" data-path="timetoevent.html"><a href="timetoevent.html#cox-proportional-hazards-model"><i class="fa fa-check"></i><b>7.1.3</b> Cox Proportional Hazards Model</a></li>
<li class="chapter" data-level="7.1.4" data-path="timetoevent.html"><a href="timetoevent.html#survival-probability"><i class="fa fa-check"></i><b>7.1.4</b> Survival Probability</a></li>
<li class="chapter" data-level="7.1.5" data-path="timetoevent.html"><a href="timetoevent.html#restricted-mean-survival-time-rmst"><i class="fa fa-check"></i><b>7.1.5</b> Restricted Mean Survival Time (RMST)</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="timetoevent.html"><a href="timetoevent.html#covariate-adjusted-estimators"><i class="fa fa-check"></i><b>7.2</b> Covariate-Adjusted Estimators</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="timetoevent.html"><a href="timetoevent.html#covariate-adjusted-estimates-of-survival-function"><i class="fa fa-check"></i><b>7.2.1</b> Covariate Adjusted Estimates of Survival Function</a></li>
<li class="chapter" data-level="7.2.2" data-path="timetoevent.html"><a href="timetoevent.html#conditional-hazard-ratio"><i class="fa fa-check"></i><b>7.2.2</b> Conditional Hazard Ratio</a></li>
<li class="chapter" data-level="7.2.3" data-path="timetoevent.html"><a href="timetoevent.html#marginal-hazard-ratio"><i class="fa fa-check"></i><b>7.2.3</b> Marginal Hazard Ratio</a></li>
<li class="chapter" data-level="7.2.4" data-path="timetoevent.html"><a href="timetoevent.html#survival-probability-1"><i class="fa fa-check"></i><b>7.2.4</b> Survival Probability</a></li>
<li class="chapter" data-level="7.2.5" data-path="timetoevent.html"><a href="timetoevent.html#restricted-mean-survival-time-rmst-1"><i class="fa fa-check"></i><b>7.2.5</b> Restricted Mean Survival Time (RMST)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="groupsequential.html"><a href="groupsequential.html"><i class="fa fa-check"></i><b>8</b> Group Sequential Designs</a>
<ul>
<li class="chapter" data-level="8.1" data-path="groupsequential.html"><a href="groupsequential.html#group-sequential-designs"><i class="fa fa-check"></i><b>8.1</b> Group Sequential Designs</a></li>
<li class="chapter" data-level="8.2" data-path="groupsequential.html"><a href="groupsequential.html#power-sample-size-calculations"><i class="fa fa-check"></i><b>8.2</b> Power &amp; Sample Size Calculations</a></li>
<li class="chapter" data-level="8.3" data-path="groupsequential.html"><a href="groupsequential.html#analyses-unadjusted-and-adjusted"><i class="fa fa-check"></i><b>8.3</b> Analyses: Unadjusted and Adjusted</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="informationadaptive.html"><a href="informationadaptive.html"><i class="fa fa-check"></i><b>9</b> Information Adaptive Designs</a>
<ul>
<li class="chapter" data-level="9.1" data-path="informationadaptive.html"><a href="informationadaptive.html#information-adaptive-designs"><i class="fa fa-check"></i><b>9.1</b> Information Adaptive Designs</a></li>
<li class="chapter" data-level="9.2" data-path="informationadaptive.html"><a href="informationadaptive.html#power-sample-size-calculations-1"><i class="fa fa-check"></i><b>9.2</b> Power &amp; Sample Size Calculations</a></li>
<li class="chapter" data-level="9.3" data-path="informationadaptive.html"><a href="informationadaptive.html#analyses-unadjusted-and-adjusted-1"><i class="fa fa-check"></i><b>9.3</b> Analyses: Unadjusted and Adjusted</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="protocol_sap.html"><a href="protocol_sap.html"><i class="fa fa-check"></i><b>10</b> Protocol and Statistical Analysis Plan Considerations</a>
<ul>
<li class="chapter" data-level="10.1" data-path="protocol_sap.html"><a href="protocol_sap.html#study-protocol"><i class="fa fa-check"></i><b>10.1</b> Study Protocol</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="protocol_sap.html"><a href="protocol_sap.html#sample-size-justification-9.4.1"><i class="fa fa-check"></i><b>10.1.1</b> Sample Size Justification (9.4.1)</a></li>
<li class="chapter" data-level="10.1.2" data-path="protocol_sap.html"><a href="protocol_sap.html#general-approach-9.4.1"><i class="fa fa-check"></i><b>10.1.2</b> General Approach (9.4.1)</a></li>
<li class="chapter" data-level="10.1.3" data-path="protocol_sap.html"><a href="protocol_sap.html#analysis-of-the-primarysecondary-endpoints-9.4.2-3"><i class="fa fa-check"></i><b>10.1.3</b> Analysis of the Primary/Secondary Endpoints (9.4.2-3)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="recommendations.html"><a href="recommendations.html"><i class="fa fa-check"></i><b>11</b> Guidance on Applying Covariate Adjustment</a>
<ul>
<li class="chapter" data-level="11.1" data-path="recommendations.html"><a href="recommendations.html#relevant-regulatory-guidance"><i class="fa fa-check"></i><b>11.1</b> Relevant Regulatory Guidance</a></li>
<li class="chapter" data-level="11.2" data-path="recommendations.html"><a href="recommendations.html#missing-covariates"><i class="fa fa-check"></i><b>11.2</b> Missing Covariates</a></li>
<li class="chapter" data-level="11.3" data-path="recommendations.html"><a href="recommendations.html#statistical-analysis-plans"><i class="fa fa-check"></i><b>11.3</b> Statistical Analysis Plans</a></li>
<li class="chapter" data-level="11.4" data-path="recommendations.html"><a href="recommendations.html#sample-size-for-adjusted-vs.-unadjusted"><i class="fa fa-check"></i><b>11.4</b> Sample size for adjusted vs. unadjusted</a></li>
<li class="chapter" data-level="11.5" data-path="recommendations.html"><a href="recommendations.html#number-of-parameters-vs.-sample-size"><i class="fa fa-check"></i><b>11.5</b> Number of parameters vs. sample size</a></li>
<li class="chapter" data-level="11.6" data-path="recommendations.html"><a href="recommendations.html#data-adaptive-covariate-adjustment"><i class="fa fa-check"></i><b>11.6</b> Data-Adaptive Covariate Adjustment</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="appendices.html"><a href="appendices.html"><i class="fa fa-check"></i><b>12</b> Appendices</a>
<ul>
<li class="chapter" data-level="12.1" data-path="appendices.html"><a href="appendices.html#appendix_a_glossary"><i class="fa fa-check"></i><b>12.1</b> Appendix A: Glossary of Terms</a></li>
<li class="chapter" data-level="12.2" data-path="appendices.html"><a href="appendices.html#appendix_b_using_r"><i class="fa fa-check"></i><b>12.2</b> Appendix B: Resources for Using R</a></li>
<li class="chapter" data-level="12.3" data-path="appendices.html"><a href="appendices.html#appendix_c_references_by_method"><i class="fa fa-check"></i><b>12.3</b> Appendix C:</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Covariate Adjustment in Randomized Trials</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="applying-covariate-adjustment-ancova-g-computation" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Applying Covariate Adjustment: ANCOVA &amp; G-Computation<a href="applying-covariate-adjustment-ancova-g-computation.html#applying-covariate-adjustment-ancova-g-computation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this next section, we will use R to produce the ANCOVA estimator, get an estimate of its standard error, and compare its precision to an unadjusted analysis using R. For this example we will use the Buprenorphine tapering trial data (CTN-03).</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb49-1" tabindex="-1"></a>data_url <span class="ot">&lt;-</span></span>
<span id="cb49-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb49-2" tabindex="-1"></a>  <span class="st">&quot;https://github.com/jbetz-jhu/CovariateAdjustmentTutorial/raw/main/SIMULATED_CTN03_220506.Rdata&quot;</span></span>
<span id="cb49-3"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb49-3" tabindex="-1"></a></span>
<span id="cb49-4"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb49-4" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="fu">url</span>(data_url))</span></code></pre></div>
<p>This .Rdata file contains two datasets: <code>ctn03_sim</code>, which has no missing data, and <code>ctn03_sim_mar</code>, where a simulated missing data mechanism has been applied.</p>
<p>The <code>stats::lm</code> function can be used to fit a linear regression model, such as the ANCOVA. While this estimator is conditional on the baseline value of the outcome, because the model is linear with an identity link, the conditional treatment effect is the same as the marginal treatment effect. When binary outcomes or nonlinear link functions are used in a regression model, the marginal and conditional associations are almost always different.</p>
<p>In order to generalize the ANCOVA to other settings, a different approach must be taken to compute the marginal treatment effect. We will use the steps outlined earlier in <a href="introduction.html#ancova">the discussion of the ANCOVA estimator</a>.</p>
<hr />
<div id="computing-the-estimate" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Computing the Estimate<a href="applying-covariate-adjustment-ancova-g-computation.html#computing-the-estimate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To compute the ANCOVA estimator, first regress the final outcome on the treatment assignment indicator and the baseline value of the outcome:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb50-1" tabindex="-1"></a><span class="co"># 1. Regress final outcome (VAS at end of taper) on treatment assignment and</span></span>
<span id="cb50-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb50-2" tabindex="-1"></a><span class="co"># outcome assessed at baseline (VAS at baseline)</span></span>
<span id="cb50-3"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb50-3" tabindex="-1"></a>vas_ancova_1 <span class="ot">&lt;-</span></span>
<span id="cb50-4"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb50-4" tabindex="-1"></a>  <span class="fu">lm</span>(</span>
<span id="cb50-5"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb50-5" tabindex="-1"></a>    <span class="at">formula =</span> vas_crave_opiates_eot <span class="sc">~</span> arm <span class="sc">+</span> vas_crave_opiates_bl,</span>
<span id="cb50-6"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb50-6" tabindex="-1"></a>    <span class="at">data =</span> ctn03_sim_mar</span>
<span id="cb50-7"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb50-7" tabindex="-1"></a>  )</span>
<span id="cb50-8"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb50-8" tabindex="-1"></a></span>
<span id="cb50-9"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb50-9" tabindex="-1"></a><span class="fu">summary</span>(vas_ancova_1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = vas_crave_opiates_eot ~ arm + vas_crave_opiates_bl, 
##     data = ctn03_sim_mar)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -54.193 -21.747  -6.874  15.151  71.637 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          24.05363    2.27269  10.584  &lt; 2e-16 ***
## arm7-day             -2.17932    2.82195  -0.772     0.44    
## vas_crave_opiates_bl  0.35910    0.07595   4.728 3.29e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 25.96 on 350 degrees of freedom
##   (163 observations deleted due to missingness)
## Multiple R-squared:  0.06006,    Adjusted R-squared:  0.05469 
## F-statistic: 11.18 on 2 and 350 DF,  p-value: 1.962e-05</code></pre>
<p>Note that the standard error reported by <code>lm()</code> is the model-based standard error, not a robust standard error or bootstrap standard error. Next, we generate the predicted outcome for each randomized individual under each treatment assignment:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-1" tabindex="-1"></a><span class="co"># 2. Generate predictions based on fitted model:</span></span>
<span id="cb52-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-2" tabindex="-1"></a><span class="co"># Their predicted outcome if they were assigned to treatment (7-day taper)</span></span>
<span id="cb52-3"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-3" tabindex="-1"></a><span class="co"># Their predicted outcome if they were assigned to control (28-day taper)</span></span>
<span id="cb52-4"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-4" tabindex="-1"></a>expected_vas_7_day <span class="ot">&lt;-</span></span>
<span id="cb52-5"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-5" tabindex="-1"></a>  <span class="fu">predict</span>(</span>
<span id="cb52-6"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-6" tabindex="-1"></a>    <span class="at">object =</span> vas_ancova_1,</span>
<span id="cb52-7"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-7" tabindex="-1"></a>    <span class="at">newdata =</span></span>
<span id="cb52-8"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-8" tabindex="-1"></a>      <span class="co"># Set all treatment to &quot;7-day&quot;</span></span>
<span id="cb52-9"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-9" tabindex="-1"></a>      <span class="fu">within</span>(</span>
<span id="cb52-10"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-10" tabindex="-1"></a>        <span class="at">data =</span> ctn03_sim_mar,</span>
<span id="cb52-11"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-11" tabindex="-1"></a>        <span class="at">expr =</span> {arm <span class="ot">=</span> <span class="st">&quot;7-day&quot;</span>}</span>
<span id="cb52-12"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-12" tabindex="-1"></a>      ),</span>
<span id="cb52-13"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-13" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb52-14"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-14" tabindex="-1"></a>  )</span>
<span id="cb52-15"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-15" tabindex="-1"></a></span>
<span id="cb52-16"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-16" tabindex="-1"></a>expected_vas_28_day <span class="ot">&lt;-</span></span>
<span id="cb52-17"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-17" tabindex="-1"></a>  <span class="fu">predict</span>(</span>
<span id="cb52-18"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-18" tabindex="-1"></a>    <span class="at">object =</span> vas_ancova_1,</span>
<span id="cb52-19"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-19" tabindex="-1"></a>    <span class="at">newdata =</span></span>
<span id="cb52-20"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-20" tabindex="-1"></a>      <span class="co"># Set all treatment to &quot;28-day&quot;</span></span>
<span id="cb52-21"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-21" tabindex="-1"></a>      <span class="fu">within</span>(</span>
<span id="cb52-22"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-22" tabindex="-1"></a>        <span class="at">data =</span> ctn03_sim_mar,</span>
<span id="cb52-23"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-23" tabindex="-1"></a>        <span class="at">expr =</span> {arm <span class="ot">=</span> <span class="st">&quot;28-day&quot;</span>}</span>
<span id="cb52-24"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-24" tabindex="-1"></a>      ),</span>
<span id="cb52-25"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-25" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb52-26"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-26" tabindex="-1"></a>  )</span>
<span id="cb52-27"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-27" tabindex="-1"></a></span>
<span id="cb52-28"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-28" tabindex="-1"></a></span>
<span id="cb52-29"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-29" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb52-30"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-30" tabindex="-1"></a>  expected_vas_7_day,</span>
<span id="cb52-31"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-31" tabindex="-1"></a>  expected_vas_28_day,</span>
<span id="cb52-32"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-32" tabindex="-1"></a>  ctn03_sim_mar[, <span class="fu">c</span>(<span class="st">&quot;arm&quot;</span>, <span class="st">&quot;vas_crave_opiates_eot&quot;</span>, <span class="st">&quot;vas_crave_opiates_bl&quot;</span>)]</span>
<span id="cb52-33"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-33" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-34"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb52-34" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##   expected_vas_7_day expected_vas_28_day   arm vas_crave_opiates_eot
## 1           27.97901            30.15833 7-day                    NA
## 2           24.38801            26.56733 7-day                     5
## 3           32.64731            34.82663 7-day                    31
## 4           24.38801            26.56733 7-day                    40
## 5           28.69721            30.87653 7-day                    51
## 6           26.18351            28.36283 7-day                     1
##   vas_crave_opiates_bl
## 1                   17
## 2                    7
## 3                   30
## 4                    7
## 5                   19
## 6                   12</code></pre>
<p>Once we’ve generated these predictions, we can compute the ANCOVA estimate of the average treatment effect:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb54-1" tabindex="-1"></a><span class="fu">mean</span>(expected_vas_7_day)</span></code></pre></div>
<pre><code>## [1] 26.88292</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb56-1" tabindex="-1"></a><span class="fu">mean</span>(expected_vas_28_day)</span></code></pre></div>
<pre><code>## [1] 29.06224</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb58-1" tabindex="-1"></a>vas_ancova_estimate <span class="ot">&lt;-</span> <span class="fu">mean</span>(expected_vas_7_day) <span class="sc">-</span> <span class="fu">mean</span>(expected_vas_28_day)</span>
<span id="cb58-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb58-2" tabindex="-1"></a>vas_ancova_estimate</span></code></pre></div>
<pre><code>## [1] -2.179321</code></pre>
<p>Notice this is the exact same as the regression coefficient for <code>arm</code> in the regression model, since there’s no treatment-covariate interactions and an identity link function.</p>
<hr />
</div>
<div id="standard-error-inference" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Standard Error &amp; Inference<a href="applying-covariate-adjustment-ancova-g-computation.html#standard-error-inference" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can obtain the standard error of the estimate two ways. The first way is using the <code>margins::margins()</code> command, using the robust standard errors from <code>sandwich::vcovHC</code>:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb60-1" tabindex="-1"></a>vas_ancova_margins <span class="ot">&lt;-</span></span>
<span id="cb60-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb60-2" tabindex="-1"></a>  margins<span class="sc">::</span><span class="fu">margins</span>(</span>
<span id="cb60-3"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb60-3" tabindex="-1"></a>    <span class="at">model =</span> vas_ancova_1,</span>
<span id="cb60-4"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb60-4" tabindex="-1"></a>    <span class="co"># Specify treatment variable</span></span>
<span id="cb60-5"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb60-5" tabindex="-1"></a>    <span class="at">variables =</span> <span class="st">&quot;arm&quot;</span>,</span>
<span id="cb60-6"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb60-6" tabindex="-1"></a>    <span class="co"># Convert to outcome scale, not link scale</span></span>
<span id="cb60-7"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb60-7" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;response&quot;</span>,</span>
<span id="cb60-8"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb60-8" tabindex="-1"></a>    <span class="co"># Obtain robust standard errors</span></span>
<span id="cb60-9"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb60-9" tabindex="-1"></a>    <span class="at">vcov =</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(<span class="at">x =</span> vas_ancova_1, <span class="at">type =</span> <span class="st">&quot;HC3&quot;</span>)</span>
<span id="cb60-10"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb60-10" tabindex="-1"></a>  )</span>
<span id="cb60-11"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb60-11" tabindex="-1"></a></span>
<span id="cb60-12"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb60-12" tabindex="-1"></a><span class="fu">summary</span>(<span class="at">object =</span> vas_ancova_margins, <span class="at">level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##    factor     AME     SE       z      p   lower  upper
##  arm7-day -2.1793 2.8680 -0.7599 0.4473 -7.8005 3.4418</code></pre>
<p>You’ll see that we now have a standard error, p-value under the hypothesis that the marginal effect is 0, and a 95% Confidence Interval for the estimate. Another way to obtain these is the bias corrected and accelerated (BCa) non-parametric bootstrap:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-1" tabindex="-1"></a><span class="co"># Write a function to produce the ANCOVA estimate</span></span>
<span id="cb62-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-2" tabindex="-1"></a>margins_fun <span class="ot">&lt;-</span></span>
<span id="cb62-3"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-3" tabindex="-1"></a>  <span class="cf">function</span>(</span>
<span id="cb62-4"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-4" tabindex="-1"></a>    data,</span>
<span id="cb62-5"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-5" tabindex="-1"></a>    <span class="at">indices =</span> <span class="cn">NULL</span>,</span>
<span id="cb62-6"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-6" tabindex="-1"></a>    formula,</span>
<span id="cb62-7"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-7" tabindex="-1"></a>    family,</span>
<span id="cb62-8"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-8" tabindex="-1"></a>    term,</span>
<span id="cb62-9"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-9" tabindex="-1"></a>    <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">&quot;difference&quot;</span>, <span class="st">&quot;ratio&quot;</span>)[<span class="dv">1</span>]</span>
<span id="cb62-10"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-10" tabindex="-1"></a>  ){</span>
<span id="cb62-11"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-11" tabindex="-1"></a>    <span class="co"># Input data must be a data.frame</span></span>
<span id="cb62-12"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-12" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">all</span>(<span class="fu">class</span>(data) <span class="sc">==</span> <span class="st">&quot;data.frame&quot;</span>)){</span>
<span id="cb62-13"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-13" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;`data` must be a data.frame: use `as.data.frame()` for a tibble.&quot;</span>)</span>
<span id="cb62-14"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-14" tabindex="-1"></a>    }</span>
<span id="cb62-15"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-15" tabindex="-1"></a>    </span>
<span id="cb62-16"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-16" tabindex="-1"></a>    <span class="co"># If bootstrap indices not supplied, use entire dataset</span></span>
<span id="cb62-17"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-17" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(indices)) indices <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data)</span>
<span id="cb62-18"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-18" tabindex="-1"></a>    </span>
<span id="cb62-19"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-19" tabindex="-1"></a>    data <span class="ot">&lt;-</span> data[indices,]</span>
<span id="cb62-20"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-20" tabindex="-1"></a>    </span>
<span id="cb62-21"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-21" tabindex="-1"></a>    glm_fit <span class="ot">&lt;-</span></span>
<span id="cb62-22"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-22" tabindex="-1"></a>      <span class="fu">glm</span>(</span>
<span id="cb62-23"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-23" tabindex="-1"></a>        <span class="at">formula =</span> formula,</span>
<span id="cb62-24"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-24" tabindex="-1"></a>        <span class="at">family =</span> family,</span>
<span id="cb62-25"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-25" tabindex="-1"></a>        <span class="at">data =</span> data</span>
<span id="cb62-26"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-26" tabindex="-1"></a>      )</span>
<span id="cb62-27"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-27" tabindex="-1"></a>    </span>
<span id="cb62-28"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-28" tabindex="-1"></a>    tx_levels <span class="ot">&lt;-</span> <span class="fu">levels</span>(data[, term])</span>
<span id="cb62-29"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-29" tabindex="-1"></a>    </span>
<span id="cb62-30"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-30" tabindex="-1"></a>    e_y_1 <span class="ot">&lt;-</span></span>
<span id="cb62-31"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-31" tabindex="-1"></a>      <span class="fu">predict</span>(</span>
<span id="cb62-32"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-32" tabindex="-1"></a>        <span class="at">object =</span> glm_fit,</span>
<span id="cb62-33"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-33" tabindex="-1"></a>        <span class="at">newdata =</span> </span>
<span id="cb62-34"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-34" tabindex="-1"></a>          <span class="fu">within</span>(</span>
<span id="cb62-35"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-35" tabindex="-1"></a>            data,</span>
<span id="cb62-36"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-36" tabindex="-1"></a>            <span class="at">expr =</span> <span class="fu">assign</span>(<span class="at">x =</span> term, <span class="at">value =</span> tx_levels[<span class="dv">2</span>])</span>
<span id="cb62-37"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-37" tabindex="-1"></a>          ),</span>
<span id="cb62-38"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-38" tabindex="-1"></a>        </span>
<span id="cb62-39"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-39" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb62-40"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-40" tabindex="-1"></a>      )</span>
<span id="cb62-41"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-41" tabindex="-1"></a>    </span>
<span id="cb62-42"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-42" tabindex="-1"></a>    e_y_0 <span class="ot">&lt;-</span></span>
<span id="cb62-43"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-43" tabindex="-1"></a>      <span class="fu">predict</span>(</span>
<span id="cb62-44"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-44" tabindex="-1"></a>        <span class="at">object =</span> glm_fit,</span>
<span id="cb62-45"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-45" tabindex="-1"></a>        <span class="at">newdata =</span> </span>
<span id="cb62-46"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-46" tabindex="-1"></a>          <span class="fu">within</span>(</span>
<span id="cb62-47"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-47" tabindex="-1"></a>            data,</span>
<span id="cb62-48"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-48" tabindex="-1"></a>            <span class="at">expr =</span> <span class="fu">assign</span>(<span class="at">x =</span> term, <span class="at">value =</span> tx_levels[<span class="dv">1</span>])</span>
<span id="cb62-49"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-49" tabindex="-1"></a>          ),</span>
<span id="cb62-50"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-50" tabindex="-1"></a>        </span>
<span id="cb62-51"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-51" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb62-52"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-52" tabindex="-1"></a>      )</span>
<span id="cb62-53"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-53" tabindex="-1"></a>    </span>
<span id="cb62-54"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-54" tabindex="-1"></a>    <span class="cf">if</span>(contrast <span class="sc">==</span> <span class="st">&quot;difference&quot;</span>){</span>
<span id="cb62-55"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-55" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">mean</span>(e_y_1) <span class="sc">-</span> <span class="fu">mean</span>(e_y_0))</span>
<span id="cb62-56"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-56" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (contrast <span class="sc">==</span> <span class="st">&quot;ratio&quot;</span>){</span>
<span id="cb62-57"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-57" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">mean</span>(e_y_1)<span class="sc">/</span><span class="fu">mean</span>(e_y_0))</span>
<span id="cb62-58"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-58" tabindex="-1"></a>    }</span>
<span id="cb62-59"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-59" tabindex="-1"></a>  }</span>
<span id="cb62-60"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-60" tabindex="-1"></a></span>
<span id="cb62-61"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-61" tabindex="-1"></a>vas_ancova_boot <span class="ot">&lt;-</span></span>
<span id="cb62-62"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-62" tabindex="-1"></a>  boot<span class="sc">::</span><span class="fu">boot</span>(</span>
<span id="cb62-63"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-63" tabindex="-1"></a>    <span class="at">data =</span> ctn03_sim_mar,</span>
<span id="cb62-64"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-64" tabindex="-1"></a>    <span class="at">statistic =</span> margins_fun,</span>
<span id="cb62-65"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-65" tabindex="-1"></a>    <span class="at">R =</span> <span class="dv">10000</span>,</span>
<span id="cb62-66"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-66" tabindex="-1"></a>      <span class="at">formula =</span> vas_crave_opiates_eot <span class="sc">~</span> arm <span class="sc">+</span> vas_crave_opiates_bl,</span>
<span id="cb62-67"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-67" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">&quot;identity&quot;</span>),</span>
<span id="cb62-68"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-68" tabindex="-1"></a>    <span class="at">term =</span> <span class="st">&quot;arm&quot;</span></span>
<span id="cb62-69"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb62-69" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb63-1" tabindex="-1"></a><span class="co"># Bootstrap results</span></span>
<span id="cb63-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb63-2" tabindex="-1"></a>vas_ancova_boot</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot::boot(data = ctn03_sim_mar, statistic = margins_fun, R = 10000, 
##     formula = vas_crave_opiates_eot ~ arm + vas_crave_opiates_bl, 
##     family = gaussian(link = &quot;identity&quot;), term = &quot;arm&quot;)
## 
## 
## Bootstrap Statistics :
##      original    bias    std. error
## t1* -2.179321 0.0631477    2.816499</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb65-1" tabindex="-1"></a><span class="co"># Bootstrap Standard Error</span></span>
<span id="cb65-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb65-2" tabindex="-1"></a><span class="fu">sd</span>(vas_ancova_boot<span class="sc">$</span>t[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 2.816499</code></pre>
<p>We can extract the standard error and produce a 95% confidence interval:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb67-1" tabindex="-1"></a>vas_ancova_boot_ci <span class="ot">&lt;-</span></span>
<span id="cb67-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb67-2" tabindex="-1"></a>  boot<span class="sc">::</span><span class="fu">boot.ci</span>(</span>
<span id="cb67-3"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb67-3" tabindex="-1"></a>    <span class="at">boot.out =</span> vas_ancova_boot,</span>
<span id="cb67-4"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb67-4" tabindex="-1"></a>    <span class="at">conf =</span> <span class="fl">0.95</span>,</span>
<span id="cb67-5"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb67-5" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;bca&quot;</span></span>
<span id="cb67-6"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb67-6" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb68-1" tabindex="-1"></a>vas_ancova_boot_ci</span></code></pre></div>
<p>We can compare these to the results from <code>margins::margins()</code>:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb69-1" tabindex="-1"></a><span class="co"># Margins SE</span></span>
<span id="cb69-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb69-2" tabindex="-1"></a>ancova_margins_se <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="at">object =</span> vas_ancova_margins, <span class="at">level =</span> <span class="fl">0.95</span>)<span class="sc">$</span>SE</span>
<span id="cb69-3"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb69-3" tabindex="-1"></a>ancova_margins_se</span></code></pre></div>
<pre><code>## [1] 2.867989</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb71-1" tabindex="-1"></a><span class="co"># Bootstrap SE</span></span>
<span id="cb71-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb71-2" tabindex="-1"></a>ancova_boot_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(vas_ancova_boot<span class="sc">$</span>t[,<span class="dv">1</span>])</span>
<span id="cb71-3"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb71-3" tabindex="-1"></a>ancova_boot_se</span></code></pre></div>
<pre><code>## [1] 2.816499</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb73-1" tabindex="-1"></a><span class="co"># Compare as ratio</span></span>
<span id="cb73-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb73-2" tabindex="-1"></a>ancova_margins_se<span class="sc">/</span>ancova_boot_se</span></code></pre></div>
<pre><code>## [1] 1.018282</code></pre>
<p>The standard errors are nearly identical using the estimated marginal effect with robust standard errors or the bootstrap.</p>
<hr />
</div>
<div id="calculating-precision-gain" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Calculating Precision Gain<a href="applying-covariate-adjustment-ancova-g-computation.html#calculating-precision-gain" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Asymptotically, the ANCOVA estimate should have precision that is equal or better than an unadjusted analysis. We can calculate the precision gain by taking the ratio of the variances, i.e. the squared standard errors, of the adjusted estimator to the unadjusted estimator.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb75-1" tabindex="-1"></a>vas_t_test <span class="ot">&lt;-</span></span>
<span id="cb75-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb75-2" tabindex="-1"></a>  <span class="fu">t.test</span>(</span>
<span id="cb75-3"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb75-3" tabindex="-1"></a>    <span class="at">formula =</span> vas_crave_opiates_eot <span class="sc">~</span> arm,</span>
<span id="cb75-4"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb75-4" tabindex="-1"></a>    <span class="at">data =</span> ctn03_sim_mar,</span>
<span id="cb75-5"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb75-5" tabindex="-1"></a>    <span class="at">var.equal =</span> <span class="cn">FALSE</span></span>
<span id="cb75-6"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb75-6" tabindex="-1"></a>  )</span>
<span id="cb75-7"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb75-7" tabindex="-1"></a></span>
<span id="cb75-8"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb75-8" tabindex="-1"></a>vas_t_test</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  vas_crave_opiates_eot by arm
## t = 0.093598, df = 316.77, p-value = 0.9255
## alternative hypothesis: true difference in means between group 28-day and group 7-day is not equal to 0
## 95 percent confidence interval:
##  -5.418971  5.960313
## sample estimates:
## mean in group 28-day  mean in group 7-day 
##             28.01325             27.74257</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb77-1" tabindex="-1"></a><span class="co"># Get unadjusted standard error</span></span>
<span id="cb77-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb77-2" tabindex="-1"></a>t_test_se <span class="ot">&lt;-</span> vas_t_test<span class="sc">$</span>stderr</span>
<span id="cb77-3"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb77-3" tabindex="-1"></a>t_test_se</span></code></pre></div>
<pre><code>## [1] 2.891841</code></pre>
<p>The precision gain is equal to the ratio of the variance, which is the square of the standard error:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb79-1" tabindex="-1"></a><span class="co"># Percentage reduction in variance adjusting for baseline outcome</span></span>
<span id="cb79-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb79-2" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> (ancova_margins_se<span class="sc">/</span>t_test_se)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 1.642819</code></pre>
<p>The precision gain in this particular example is rather small, but we have only adjusted for one potential covariate. However, there are several other baseline variables we did not include in the model. We can see if the gain in precision is larger when these other variables are included. We should also include the stability dose in the outcome, since randomization was stratified by this variable:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-1" tabindex="-1"></a>vas_ancova_2 <span class="ot">&lt;-</span></span>
<span id="cb81-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-2" tabindex="-1"></a>  <span class="fu">glm</span>(</span>
<span id="cb81-3"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-3" tabindex="-1"></a>    <span class="at">formula =</span> vas_crave_opiates_eot <span class="sc">~</span> </span>
<span id="cb81-4"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-4" tabindex="-1"></a>      arm <span class="sc">+</span> vas_crave_opiates_bl <span class="sc">+</span> stability_dose <span class="sc">+</span></span>
<span id="cb81-5"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-5" tabindex="-1"></a>      arsw_score_bl <span class="sc">+</span> cows_total_score_bl <span class="sc">+</span></span>
<span id="cb81-6"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-6" tabindex="-1"></a>      vas_current_withdrawal_bl <span class="sc">+</span> vas_study_tx_help_bl <span class="sc">+</span> uds_any_positive_bl,</span>
<span id="cb81-7"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-7" tabindex="-1"></a>    <span class="at">data =</span> ctn03_sim_mar</span>
<span id="cb81-8"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-8" tabindex="-1"></a>  )</span>
<span id="cb81-9"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-9" tabindex="-1"></a></span>
<span id="cb81-10"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-10" tabindex="-1"></a>vas_ancova_margins_2 <span class="ot">&lt;-</span></span>
<span id="cb81-11"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-11" tabindex="-1"></a>  margins<span class="sc">::</span><span class="fu">margins</span>(</span>
<span id="cb81-12"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-12" tabindex="-1"></a>    <span class="at">model =</span> vas_ancova_2,</span>
<span id="cb81-13"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-13" tabindex="-1"></a>    <span class="co"># Specify treatment variable</span></span>
<span id="cb81-14"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-14" tabindex="-1"></a>    <span class="at">variables =</span> <span class="st">&quot;arm&quot;</span>,</span>
<span id="cb81-15"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-15" tabindex="-1"></a>    <span class="co"># Convert to outcome scale, not link scale</span></span>
<span id="cb81-16"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-16" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;response&quot;</span>,</span>
<span id="cb81-17"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-17" tabindex="-1"></a>    <span class="co"># Obtain robust standard errors</span></span>
<span id="cb81-18"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-18" tabindex="-1"></a>    <span class="at">vcov =</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(<span class="at">x =</span> vas_ancova_2, <span class="at">type =</span> <span class="st">&quot;HC3&quot;</span>)</span>
<span id="cb81-19"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-19" tabindex="-1"></a>  )</span>
<span id="cb81-20"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-20" tabindex="-1"></a></span>
<span id="cb81-21"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-21" tabindex="-1"></a>ancova_margins_2_se <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="at">object =</span> vas_ancova_margins_2, <span class="at">level =</span> <span class="fl">0.95</span>)<span class="sc">$</span>SE</span>
<span id="cb81-22"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-22" tabindex="-1"></a></span>
<span id="cb81-23"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-23" tabindex="-1"></a><span class="co"># Percentage reduction in variance adjusting for baseline outcome</span></span>
<span id="cb81-24"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb81-24" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> (ancova_margins_2_se<span class="sc">/</span>t_test_se)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 7.590248</code></pre>
<p>Including these other covariates leads to a larger gain in precision.</p>
<hr />
</div>
<div id="covariate-adjustment-with-binary-outcomes" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Covariate Adjustment with Binary Outcomes<a href="applying-covariate-adjustment-ancova-g-computation.html#covariate-adjustment-with-binary-outcomes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When the outcome is binary, the only difference in the approach is fitting a logistic regression with a nonlinear link instead of multiple regression with an identity link:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb83-1" tabindex="-1"></a>uds_opioids_glm <span class="ot">&lt;-</span></span>
<span id="cb83-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb83-2" tabindex="-1"></a>  <span class="fu">glm</span>(</span>
<span id="cb83-3"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb83-3" tabindex="-1"></a>    <span class="at">formula =</span> </span>
<span id="cb83-4"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb83-4" tabindex="-1"></a>      uds_opioids_eot <span class="sc">==</span> <span class="st">&quot;Negative&quot;</span> <span class="sc">~</span> </span>
<span id="cb83-5"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb83-5" tabindex="-1"></a>      arm <span class="sc">+</span> uds_opioids_bl <span class="sc">+</span> stability_dose <span class="sc">+</span></span>
<span id="cb83-6"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb83-6" tabindex="-1"></a>      arsw_score_bl <span class="sc">+</span> cows_total_score_bl <span class="sc">+</span></span>
<span id="cb83-7"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb83-7" tabindex="-1"></a>      vas_current_withdrawal_bl <span class="sc">+</span> vas_study_tx_help_bl,</span>
<span id="cb83-8"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb83-8" tabindex="-1"></a>    <span class="at">data =</span> ctn03_sim_mar,</span>
<span id="cb83-9"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb83-9" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)</span>
<span id="cb83-10"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb83-10" tabindex="-1"></a>  )</span>
<span id="cb83-11"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb83-11" tabindex="-1"></a></span>
<span id="cb83-12"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb83-12" tabindex="-1"></a><span class="fu">summary</span>(uds_opioids_glm)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = uds_opioids_eot == &quot;Negative&quot; ~ arm + uds_opioids_bl + 
##     stability_dose + arsw_score_bl + cows_total_score_bl + vas_current_withdrawal_bl + 
##     vas_study_tx_help_bl, family = binomial(link = &quot;logit&quot;), 
##     data = ctn03_sim_mar)
## 
## Coefficients:
##                            Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                0.019885   0.759146   0.026  0.97910    
## arm7-day                   0.257685   0.265805   0.969  0.33232    
## uds_opioids_blPositive    -2.607045   0.297263  -8.770  &lt; 2e-16 ***
## stability_dose16 mg        1.168914   0.459625   2.543  0.01098 *  
## stability_dose24 mg        1.170684   0.428484   2.732  0.00629 ** 
## arsw_score_bl             -0.002279   0.012769  -0.178  0.85837    
## cows_total_score_bl        0.187241   0.110601   1.693  0.09047 .  
## vas_current_withdrawal_bl -0.015190   0.013636  -1.114  0.26529    
## vas_study_tx_help_bl       0.001393   0.006972   0.200  0.84165    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 467.70  on 352  degrees of freedom
## Residual deviance: 362.37  on 344  degrees of freedom
##   (163 observations deleted due to missingness)
## AIC: 380.37
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Logistic regression gives coefficients on the log odds scale, which can be exponentiated to obtain a conditional odds ratio, a relative measure. The <code>margins::margins</code> function gives the marginal estimate on the risk difference scale, which is an absolute measure:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb85-1" tabindex="-1"></a>uds_opioids_margins <span class="ot">&lt;-</span></span>
<span id="cb85-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb85-2" tabindex="-1"></a>  margins<span class="sc">::</span><span class="fu">margins</span>(</span>
<span id="cb85-3"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb85-3" tabindex="-1"></a>    <span class="at">model =</span> uds_opioids_glm,</span>
<span id="cb85-4"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb85-4" tabindex="-1"></a>    <span class="co"># Specify treatment variable</span></span>
<span id="cb85-5"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb85-5" tabindex="-1"></a>    <span class="at">variables =</span> <span class="st">&quot;arm&quot;</span>,</span>
<span id="cb85-6"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb85-6" tabindex="-1"></a>    <span class="co"># Convert to outcome scale, not link scale</span></span>
<span id="cb85-7"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb85-7" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;response&quot;</span>,</span>
<span id="cb85-8"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb85-8" tabindex="-1"></a>    <span class="co"># Obtain robust standard errors</span></span>
<span id="cb85-9"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb85-9" tabindex="-1"></a>    <span class="at">vcov =</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(<span class="at">x =</span> uds_opioids_glm, <span class="at">type =</span> <span class="st">&quot;HC3&quot;</span>)</span>
<span id="cb85-10"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb85-10" tabindex="-1"></a>  )</span>
<span id="cb85-11"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb85-11" tabindex="-1"></a></span>
<span id="cb85-12"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb85-12" tabindex="-1"></a><span class="fu">summary</span>(uds_opioids_margins)</span></code></pre></div>
<pre><code>##    factor    AME     SE      z      p   lower  upper
##  arm7-day 0.0433 0.0469 0.9238 0.3556 -0.0486 0.1353</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb87-1" tabindex="-1"></a><span class="fu">confint</span>(uds_opioids_margins)</span></code></pre></div>
<pre><code>##                lower     upper
## arm7-day -0.04860374 0.1352633</code></pre>
<p>A risk ratio could be obtained by using <code>margins_fun</code> from above, specifying <code>contrast = "ratio"</code>, and obtaining the standard error and confidence interval via the bootstrap. In the event that a marginal odds ratio is of interest, specifying <code>type = "link"</code> in the <code>margins::margins</code> call gives a marginal log odds ratio, which could be exponentiated to obtain a marginal odds ratio.</p>
<hr />
</div>
<div id="stratified-randomization-covariate-adjustment" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Stratified Randomization &amp; Covariate Adjustment<a href="applying-covariate-adjustment-ancova-g-computation.html#stratified-randomization-covariate-adjustment" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When stratified randomization is employed, additional benefits in precision can be realized by using covariate adjustment and a variance estimator designed for covariate adaptive designs. First, source the ICAD code from Github:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb89-1" tabindex="-1"></a>icad_link <span class="ot">&lt;-</span></span>
<span id="cb89-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb89-2" tabindex="-1"></a>  <span class="st">&quot;https://raw.githubusercontent.com/BingkaiWang/covariate-adaptive/master/R/ICAD.R&quot;</span></span>
<span id="cb89-3"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb89-3" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">url</span>(icad_link))</span></code></pre></div>
<p>Next, we specify which covariates are included in the model, excluding those in the strata variable, and call ICAD:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb90-1" tabindex="-1"></a>baseline_covariates <span class="ot">&lt;-</span></span>
<span id="cb90-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb90-2" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;uds_opioids_bl&quot;</span>, <span class="st">&quot;arsw_score_bl&quot;</span>, <span class="st">&quot;cows_total_score_bl&quot;</span>,</span>
<span id="cb90-3"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb90-3" tabindex="-1"></a>    <span class="st">&quot;vas_current_withdrawal_bl&quot;</span>, <span class="st">&quot;vas_study_tx_help_bl&quot;</span>)</span>
<span id="cb90-4"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb90-4" tabindex="-1"></a></span>
<span id="cb90-5"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb90-5" tabindex="-1"></a>vas_icad <span class="ot">&lt;-</span></span>
<span id="cb90-6"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb90-6" tabindex="-1"></a>  <span class="fu">ICAD</span>(</span>
<span id="cb90-7"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb90-7" tabindex="-1"></a>    <span class="at">Y =</span> <span class="dv">1</span><span class="sc">*</span>(ctn03_sim_mar<span class="sc">$</span>uds_opioids_eot <span class="sc">==</span> <span class="st">&quot;Negative&quot;</span>), </span>
<span id="cb90-8"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb90-8" tabindex="-1"></a>    <span class="at">A =</span> <span class="dv">1</span><span class="sc">*</span>(ctn03_sim_mar<span class="sc">$</span>arm <span class="sc">==</span> <span class="st">&quot;7-day&quot;</span>), <span class="co"># Treatment indicator - Must be 1/0</span></span>
<span id="cb90-9"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb90-9" tabindex="-1"></a>    <span class="at">Strata =</span> ctn03_sim_mar<span class="sc">$</span>stability_dose, <span class="co"># Randomization Stratum</span></span>
<span id="cb90-10"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb90-10" tabindex="-1"></a>    <span class="at">W =</span> ctn03_sim_mar[, baseline_covariates], <span class="co"># Baseline Covariates</span></span>
<span id="cb90-11"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb90-11" tabindex="-1"></a>    <span class="at">pi =</span> <span class="fl">0.5</span>, <span class="co"># 1:1 Randomization,</span></span>
<span id="cb90-12"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb90-12" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span></span>
<span id="cb90-13"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb90-13" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Warning in eval(family$initialize): non-integer #successes in a binomial glm!</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb92-1" tabindex="-1"></a>vas_icad</span></code></pre></div>
<pre><code>##                            est         var    CI.lower  CI.upper
## unadjsed            0.07068389 0.002601561 -0.02928505 0.1706528
## adjusted-for-strata 0.07374103 0.002601386 -0.02622455 0.1737066
## adjusted-for-all    0.04332980 0.001889907 -0.04187583 0.1285354
## drwls               0.04427818 0.002044182 -0.04433696 0.1328933</code></pre>
<p>We can see that the ‘adjusted-for-all’ estimator, which uses a specialized variance estimator for covariate adaptive designs, has a lower variance than the covariate adjusted estimator obtained using <code>margins</code>, even though we are adjusting for the same covariates. This is the result of the additional precision gains from the covariate-adaptive variance estimator. The doubly robust weighted least squares (<code>drwls</code>) estimator will be discussed later on.</p>
<p>Specifying <code>family = "binomial"</code> allows for marginal effects with binary outcomes:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb94-1" tabindex="-1"></a>baseline_covariates <span class="ot">&lt;-</span></span>
<span id="cb94-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb94-2" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;vas_crave_opiates_bl&quot;</span>, <span class="st">&quot;arsw_score_bl&quot;</span>,</span>
<span id="cb94-3"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb94-3" tabindex="-1"></a>    <span class="st">&quot;cows_total_score_bl&quot;</span>, <span class="st">&quot;vas_current_withdrawal_bl&quot;</span>, <span class="st">&quot;vas_study_tx_help_bl&quot;</span>,</span>
<span id="cb94-4"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb94-4" tabindex="-1"></a>    <span class="st">&quot;uds_any_positive_bl&quot;</span>)</span>
<span id="cb94-5"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb94-5" tabindex="-1"></a></span>
<span id="cb94-6"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb94-6" tabindex="-1"></a>uds_icad <span class="ot">&lt;-</span></span>
<span id="cb94-7"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb94-7" tabindex="-1"></a>  <span class="fu">ICAD</span>(</span>
<span id="cb94-8"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb94-8" tabindex="-1"></a>    <span class="at">Y =</span> ctn03_sim_mar<span class="sc">$</span>vas_crave_opiates_eot, </span>
<span id="cb94-9"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb94-9" tabindex="-1"></a>    <span class="at">A =</span> <span class="dv">1</span><span class="sc">*</span>(ctn03_sim_mar<span class="sc">$</span>arm <span class="sc">==</span> <span class="st">&quot;7-day&quot;</span>), <span class="co"># Treatment indicator - Must be 1/0</span></span>
<span id="cb94-10"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb94-10" tabindex="-1"></a>    <span class="at">Strata =</span> ctn03_sim_mar<span class="sc">$</span>stability_dose, <span class="co"># Randomization Stratum</span></span>
<span id="cb94-11"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb94-11" tabindex="-1"></a>    <span class="at">W =</span> ctn03_sim_mar[, baseline_covariates], <span class="co"># Baseline Covariates</span></span>
<span id="cb94-12"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb94-12" tabindex="-1"></a>    <span class="at">pi =</span> <span class="fl">0.5</span> <span class="co"># 1:1 Randomization</span></span>
<span id="cb94-13"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb94-13" tabindex="-1"></a>  )</span>
<span id="cb94-14"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb94-14" tabindex="-1"></a></span>
<span id="cb94-15"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb94-15" tabindex="-1"></a>uds_icad</span></code></pre></div>
<pre><code>##                            est      var  CI.lower CI.upper
## unadjsed            -0.2706708 8.068289 -5.837896 5.296555
## adjusted-for-strata -0.5224149 8.068084 -6.089570 5.044740
## adjusted-for-all    -0.9106801 6.581495 -5.938855 4.117495
## drwls               -0.9485718 6.956200 -6.117900 4.220757</code></pre>
<hr />
</div>
<div id="missing-outcome-data-inverse-weighting" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Missing Outcome Data: Inverse Weighting<a href="applying-covariate-adjustment-ancova-g-computation.html#missing-outcome-data-inverse-weighting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far, we have not discussed the issue of missing outcome data. While the G-computation estimator is robust to arbitrary model misspecification, it is only valid if data are missing completely at random (MCAR): missingness is unrelated to either the observed or unobserved data. If this were the case, we should not see any association between the baseline covariates and missingness in the VAS opiate craving scores at the end-of-taper visit. We can assess this using a generalized additive model (GAM):</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb96-1" tabindex="-1"></a>vas_mar_glm <span class="ot">&lt;-</span></span>
<span id="cb96-2"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb96-2" tabindex="-1"></a>  mgcv<span class="sc">::</span><span class="fu">gam</span>(</span>
<span id="cb96-3"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb96-3" tabindex="-1"></a>    <span class="at">formula =</span> </span>
<span id="cb96-4"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb96-4" tabindex="-1"></a>      <span class="fu">is.na</span>(vas_crave_opiates_eot) <span class="sc">~</span></span>
<span id="cb96-5"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb96-5" tabindex="-1"></a>      arm <span class="sc">+</span> stability_dose <span class="sc">+</span></span>
<span id="cb96-6"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb96-6" tabindex="-1"></a>      <span class="fu">s</span>(age) <span class="sc">+</span> sex <span class="sc">+</span></span>
<span id="cb96-7"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb96-7" tabindex="-1"></a>      <span class="fu">s</span>(vas_crave_opiates_bl) <span class="sc">+</span> <span class="fu">s</span>(arsw_score_bl) <span class="sc">+</span> <span class="fu">s</span>(cows_total_score_bl) <span class="sc">+</span></span>
<span id="cb96-8"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb96-8" tabindex="-1"></a>      <span class="fu">s</span>(vas_current_withdrawal_bl) <span class="sc">+</span> <span class="fu">s</span>(vas_study_tx_help_bl) <span class="sc">+</span></span>
<span id="cb96-9"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb96-9" tabindex="-1"></a>      uds_any_positive_bl,</span>
<span id="cb96-10"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb96-10" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>),</span>
<span id="cb96-11"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb96-11" tabindex="-1"></a>    <span class="at">data =</span> ctn03_sim_mar</span>
<span id="cb96-12"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb96-12" tabindex="-1"></a>  )</span>
<span id="cb96-13"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb96-13" tabindex="-1"></a></span>
<span id="cb96-14"><a href="applying-covariate-adjustment-ancova-g-computation.html#cb96-14" tabindex="-1"></a><span class="fu">summary</span>(vas_mar_glm)</span></code></pre></div>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## is.na(vas_crave_opiates_eot) ~ arm + stability_dose + s(age) + 
##     sex + s(vas_crave_opiates_bl) + s(arsw_score_bl) + s(cows_total_score_bl) + 
##     s(vas_current_withdrawal_bl) + s(vas_study_tx_help_bl) + 
##     uds_any_positive_bl
## 
## Parametric coefficients:
##                             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                 -1.80921    0.56096  -3.225  0.00126 ** 
## arm7-day                    -1.01189    0.20978  -4.824 1.41e-06 ***
## stability_dose16 mg          1.74449    0.57581   3.030  0.00245 ** 
## stability_dose24 mg          1.46083    0.56381   2.591  0.00957 ** 
## sexFemale                    0.11516    0.22339   0.516  0.60620    
## uds_any_positive_blPositive -0.07541    0.21609  -0.349  0.72711    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                                edf Ref.df Chi.sq p-value   
## s(age)                       1.758  2.210  1.947  0.4526   
## s(vas_crave_opiates_bl)      1.000  1.000  1.436  0.2308   
## s(arsw_score_bl)             1.000  1.000  7.327  0.0068 **
## s(cows_total_score_bl)       3.110  3.839  6.372  0.1944   
## s(vas_current_withdrawal_bl) 2.120  2.692  7.016  0.0561 . 
## s(vas_study_tx_help_bl)      1.000  1.000  1.542  0.2143   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.0853   Deviance explained = 9.61%
## UBRE = 0.18961  Scale est. = 1         n = 516</code></pre>
<p>The GAM model shows that, all other things being equal, missingness was lower in the 7-day arm, higher in individuals on 16 or 24 mg stability doses, and was associated with some of the baseline outcome measures. In the next section, we will discuss methods that can be robust to model misspecification and do not require the MCAR assumption.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="using_r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="doublyrobust.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/covariateadjustment/covariateadjustment.github.io/edit/main/04-Standardization.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
