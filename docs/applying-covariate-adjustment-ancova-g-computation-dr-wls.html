<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Applying Covariate Adjustment: ANCOVA, G-Computation, DR-WLS | Covariate Adjustment in Randomized Trials</title>
  <meta name="description" content="<p>This a series of tutorials meant to help investigators apply covariate
adjusted analyses in randomized trials.</p>" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Applying Covariate Adjustment: ANCOVA, G-Computation, DR-WLS | Covariate Adjustment in Randomized Trials" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This a series of tutorials meant to help investigators apply covariate
adjusted analyses in randomized trials.</p>" />
  <meta name="github-repo" content="covariateadjustment/covariateadjustment.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Applying Covariate Adjustment: ANCOVA, G-Computation, DR-WLS | Covariate Adjustment in Randomized Trials" />
  
  <meta name="twitter:description" content="<p>This a series of tutorials meant to help investigators apply covariate
adjusted analyses in randomized trials.</p>" />
  

<meta name="author" content="Josh Betz, Kelly van Lancker, and Michael Rosenblum" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="using_r.html"/>
<link rel="next" href="doublyrobust.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/table1-1.0/table1_defaults.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Covariate Adjustment in Randomized Trials</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> The Book</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#using-this-book"><i class="fa fa-check"></i><b>1.1</b> Using this Book</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#case-studies"><i class="fa fa-check"></i><b>1.2</b> Case Studies</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#ctn_03"><i class="fa fa-check"></i><b>1.2.1</b> Buprenorphine tapering schedule and illicit opioid use: CTN-03</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#mistie_iii"><i class="fa fa-check"></i><b>1.2.2</b> Functional Outcome in Hemorrhagic Stroke: MISTIE III</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#notation"><i class="fa fa-check"></i><b>2.1</b> Notation and Assumptions</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#ancova"><i class="fa fa-check"></i><b>2.2</b> The Analysis of Covariance (ANCOVA)</a></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#generalizing-the-ancova-g-computation"><i class="fa fa-check"></i><b>2.3</b> Generalizing the ANCOVA: G-computation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="estimands.html"><a href="estimands.html"><i class="fa fa-check"></i><b>3</b> Targets of Inference: Estimands</a>
<ul>
<li class="chapter" data-level="3.1" data-path="estimands.html"><a href="estimands.html#estimands-for-continuous-and-binary-outcomes"><i class="fa fa-check"></i><b>3.1</b> Estimands for Continuous and Binary Outcomes</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="estimands.html"><a href="estimands.html#difference-in-means"><i class="fa fa-check"></i><b>3.1.1</b> Difference in Means</a></li>
<li class="chapter" data-level="3.1.2" data-path="estimands.html"><a href="estimands.html#ratio-of-means"><i class="fa fa-check"></i><b>3.1.2</b> Ratio of Means</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="estimands.html"><a href="estimands.html#ordinal_estimands"><i class="fa fa-check"></i><b>3.2</b> Estimands for Ordinal Outcomes</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="estimands.html"><a href="estimands.html#difference-in-mean-utility"><i class="fa fa-check"></i><b>3.2.1</b> Difference in Mean Utility</a></li>
<li class="chapter" data-level="3.2.2" data-path="estimands.html"><a href="estimands.html#mann-whitney-m-w-estimand"><i class="fa fa-check"></i><b>3.2.2</b> Mann-Whitney (M-W) Estimand</a></li>
<li class="chapter" data-level="3.2.3" data-path="estimands.html"><a href="estimands.html#log-odds-ratio-lor"><i class="fa fa-check"></i><b>3.2.3</b> Log Odds Ratio (LOR)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="estimands.html"><a href="estimands.html#survival_estimands"><i class="fa fa-check"></i><b>3.3</b> Survival/Time-To-Event Outcomes</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="estimands.html"><a href="estimands.html#survival-function"><i class="fa fa-check"></i><b>3.3.1</b> Survival Function</a></li>
<li class="chapter" data-level="3.3.2" data-path="estimands.html"><a href="estimands.html#hazard-ratio"><i class="fa fa-check"></i><b>3.3.2</b> Hazard Ratio</a></li>
<li class="chapter" data-level="3.3.3" data-path="estimands.html"><a href="estimands.html#restricted-mean-survival-time"><i class="fa fa-check"></i><b>3.3.3</b> Restricted Mean Survival Time</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="using_r.html"><a href="using_r.html"><i class="fa fa-check"></i><b>4</b> Using R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="using_r.html"><a href="using_r.html#installing-packages"><i class="fa fa-check"></i><b>4.1</b> Installing Packages</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="using_r.html"><a href="using_r.html#packages-from-cran"><i class="fa fa-check"></i><b>4.1.1</b> Packages from CRAN</a></li>
<li class="chapter" data-level="4.1.2" data-path="using_r.html"><a href="using_r.html#packages-from-github"><i class="fa fa-check"></i><b>4.1.2</b> Packages from Github</a></li>
<li class="chapter" data-level="4.1.3" data-path="using_r.html"><a href="using_r.html#loading-packages-into-workspace"><i class="fa fa-check"></i><b>4.1.3</b> Loading Packages into Workspace</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="using_r.html"><a href="using_r.html#loading-the-data-mistie-iii"><i class="fa fa-check"></i><b>4.2</b> Loading the Data: MISTIE-III</a></li>
<li class="chapter" data-level="4.3" data-path="using_r.html"><a href="using_r.html#assessing-baseline-balance"><i class="fa fa-check"></i><b>4.3</b> Assessing Baseline Balance</a></li>
<li class="chapter" data-level="4.4" data-path="using_r.html"><a href="using_r.html#visualizing-data"><i class="fa fa-check"></i><b>4.4</b> Visualizing Data</a></li>
<li class="chapter" data-level="4.5" data-path="using_r.html"><a href="using_r.html#fitting-regression-models"><i class="fa fa-check"></i><b>4.5</b> Fitting Regression Models</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="using_r.html"><a href="using_r.html#generalized-linear-model"><i class="fa fa-check"></i><b>4.5.1</b> Generalized Linear Model</a></li>
<li class="chapter" data-level="4.5.2" data-path="using_r.html"><a href="using_r.html#logrank-test-and-cox-proportional-hazards-model"><i class="fa fa-check"></i><b>4.5.2</b> Logrank Test and Cox Proportional Hazards Model</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="using_r.html"><a href="using_r.html#variance-estimation"><i class="fa fa-check"></i><b>4.6</b> Variance Estimation</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="using_r.html"><a href="using_r.html#robust-standard-errors"><i class="fa fa-check"></i><b>4.6.1</b> Robust Standard Errors</a></li>
<li class="chapter" data-level="4.6.2" data-path="using_r.html"><a href="using_r.html#bootstrap-estimator"><i class="fa fa-check"></i><b>4.6.2</b> Bootstrap Estimator</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="using_r.html"><a href="using_r.html#addressing-multiplicity"><i class="fa fa-check"></i><b>4.7</b> Addressing Multiplicity</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="applying-covariate-adjustment-ancova-g-computation-dr-wls.html"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html"><i class="fa fa-check"></i><b>5</b> Applying Covariate Adjustment: ANCOVA, G-Computation, DR-WLS</a>
<ul>
<li class="chapter" data-level="5.1" data-path="applying-covariate-adjustment-ancova-g-computation-dr-wls.html"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#calculating-precision-gain"><i class="fa fa-check"></i><b>5.1</b> Calculating Precision Gain</a></li>
<li class="chapter" data-level="5.2" data-path="applying-covariate-adjustment-ancova-g-computation-dr-wls.html"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#missing-outcome-data-inverse-weighting"><i class="fa fa-check"></i><b>5.2</b> Missing Outcome Data: Inverse Weighting</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="doublyrobust.html"><a href="doublyrobust.html"><i class="fa fa-check"></i><b>6</b> Doubly Robust Estimators</a>
<ul>
<li class="chapter" data-level="6.1" data-path="doublyrobust.html"><a href="doublyrobust.html#augmented-inverse-probability-weighted-estimation"><i class="fa fa-check"></i><b>6.1</b> Augmented Inverse Probability Weighted Estimation</a></li>
<li class="chapter" data-level="6.2" data-path="doublyrobust.html"><a href="doublyrobust.html#targeted-maximum-likelihood-estimation"><i class="fa fa-check"></i><b>6.2</b> Targeted Maximum Likelihood Estimation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="timetoevent.html"><a href="timetoevent.html"><i class="fa fa-check"></i><b>7</b> Time-To-Event Outcomes</a>
<ul>
<li class="chapter" data-level="7.1" data-path="timetoevent.html"><a href="timetoevent.html#unadjusted-estimators"><i class="fa fa-check"></i><b>7.1</b> Unadjusted Estimators</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="timetoevent.html"><a href="timetoevent.html#kaplan-meier-estimator"><i class="fa fa-check"></i><b>7.1.1</b> Kaplan-Meier Estimator</a></li>
<li class="chapter" data-level="7.1.2" data-path="timetoevent.html"><a href="timetoevent.html#logrank-test"><i class="fa fa-check"></i><b>7.1.2</b> Logrank Test</a></li>
<li class="chapter" data-level="7.1.3" data-path="timetoevent.html"><a href="timetoevent.html#survival-probability"><i class="fa fa-check"></i><b>7.1.3</b> Survival Probability</a></li>
<li class="chapter" data-level="7.1.4" data-path="timetoevent.html"><a href="timetoevent.html#restricted-mean-survival-time-rmst"><i class="fa fa-check"></i><b>7.1.4</b> Restricted Mean Survival Time (RMST)</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="timetoevent.html"><a href="timetoevent.html#event-driven-trials"><i class="fa fa-check"></i><b>7.2</b> Event-Driven Trials</a></li>
<li class="chapter" data-level="7.3" data-path="timetoevent.html"><a href="timetoevent.html#covariate-adjusted-estimators"><i class="fa fa-check"></i><b>7.3</b> Covariate-Adjusted Estimators</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="timetoevent.html"><a href="timetoevent.html#kaplan-meier-estimator-1"><i class="fa fa-check"></i><b>7.3.1</b> Kaplan-Meier Estimator</a></li>
<li class="chapter" data-level="7.3.2" data-path="timetoevent.html"><a href="timetoevent.html#survival-probability-1"><i class="fa fa-check"></i><b>7.3.2</b> Survival Probability</a></li>
<li class="chapter" data-level="7.3.3" data-path="timetoevent.html"><a href="timetoevent.html#restricted-mean-survival-time-rmst-1"><i class="fa fa-check"></i><b>7.3.3</b> Restricted Mean Survival Time (RMST)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="groupsequential.html"><a href="groupsequential.html"><i class="fa fa-check"></i><b>8</b> Group Sequential Designs</a>
<ul>
<li class="chapter" data-level="8.1" data-path="groupsequential.html"><a href="groupsequential.html#group-sequential-designs"><i class="fa fa-check"></i><b>8.1</b> Group Sequential Designs</a></li>
<li class="chapter" data-level="8.2" data-path="groupsequential.html"><a href="groupsequential.html#power-sample-size-calculations"><i class="fa fa-check"></i><b>8.2</b> Power &amp; Sample Size Calculations</a></li>
<li class="chapter" data-level="8.3" data-path="groupsequential.html"><a href="groupsequential.html#analyses-unadjusted-and-adjusted"><i class="fa fa-check"></i><b>8.3</b> Analyses: Unadjusted and Adjusted</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="informationadaptive.html"><a href="informationadaptive.html"><i class="fa fa-check"></i><b>9</b> Information Adaptive Designs</a>
<ul>
<li class="chapter" data-level="9.1" data-path="informationadaptive.html"><a href="informationadaptive.html#information-adaptive-designs"><i class="fa fa-check"></i><b>9.1</b> Information Adaptive Designs</a></li>
<li class="chapter" data-level="9.2" data-path="informationadaptive.html"><a href="informationadaptive.html#power-sample-size-calculations-1"><i class="fa fa-check"></i><b>9.2</b> Power &amp; Sample Size Calculations</a></li>
<li class="chapter" data-level="9.3" data-path="informationadaptive.html"><a href="informationadaptive.html#analyses-unadjusted-and-adjusted-1"><i class="fa fa-check"></i><b>9.3</b> Analyses: Unadjusted and Adjusted</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="recommendations.html"><a href="recommendations.html"><i class="fa fa-check"></i><b>10</b> Guidance on Applying Covariate Adjustment</a>
<ul>
<li class="chapter" data-level="10.1" data-path="recommendations.html"><a href="recommendations.html#missing-covariates"><i class="fa fa-check"></i><b>10.1</b> Missing Covariates</a></li>
<li class="chapter" data-level="10.2" data-path="recommendations.html"><a href="recommendations.html#statistical-analysis-plans"><i class="fa fa-check"></i><b>10.2</b> Statistical Analysis Plans</a></li>
<li class="chapter" data-level="10.3" data-path="recommendations.html"><a href="recommendations.html#sample-size-for-adjusted-vs.-unadjusted"><i class="fa fa-check"></i><b>10.3</b> Sample size for adjusted vs. unadjusted</a></li>
<li class="chapter" data-level="10.4" data-path="recommendations.html"><a href="recommendations.html#number-of-parameters-vs.-sample-size"><i class="fa fa-check"></i><b>10.4</b> Number of parameters vs. sample size</a></li>
<li class="chapter" data-level="10.5" data-path="recommendations.html"><a href="recommendations.html#data-adaptive-covariate-adjustment"><i class="fa fa-check"></i><b>10.5</b> Data-Adaptive Covariate Adjustment</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="appendices.html"><a href="appendices.html"><i class="fa fa-check"></i><b>11</b> Appendices</a>
<ul>
<li class="chapter" data-level="11.1" data-path="appendices.html"><a href="appendices.html#appendix_a_glossary"><i class="fa fa-check"></i><b>11.1</b> Appendix A: Glossary of Terms</a></li>
<li class="chapter" data-level="11.2" data-path="appendices.html"><a href="appendices.html#appendix_b_using_r"><i class="fa fa-check"></i><b>11.2</b> Appendix B: Resources for Using R</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>12</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Covariate Adjustment in Randomized Trials</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="applying-covariate-adjustment-ancova-g-computation-dr-wls" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Applying Covariate Adjustment: ANCOVA, G-Computation, DR-WLS<a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#applying-covariate-adjustment-ancova-g-computation-dr-wls" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this next section, we will use R to produce the ANCOVA estimator, get an estimate of its standard error, and compare its precision to an unadjusted analysis using R. For this example we will use the Buprenorphine tapering trial data (CTN-03).</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb46-1" tabindex="-1"></a>data_url <span class="ot">&lt;-</span></span>
<span id="cb46-2"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb46-2" tabindex="-1"></a>  <span class="st">&quot;https://github.com/jbetz-jhu/CovariateAdjustmentTutorial/raw/main/SIMULATED_CTN03_220506.Rdata&quot;</span></span>
<span id="cb46-3"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb46-3" tabindex="-1"></a></span>
<span id="cb46-4"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb46-4" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="fu">url</span>(data_url))</span></code></pre></div>
<p>This .Rdata file contains two datasets: <code>ctn03_sim</code>, which has no missing data, and <code>ctn03_sim_mar</code>, where a simulated missing data mechanism has been applied.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb47-1" tabindex="-1"></a><span class="co"># 1. Regress final outcome (VAS at end of taper) on treatment assignment and</span></span>
<span id="cb47-2"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb47-2" tabindex="-1"></a><span class="co"># outcome assessed at baseline (VAS at baseline)</span></span>
<span id="cb47-3"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb47-3" tabindex="-1"></a>vas_ancova_1 <span class="ot">&lt;-</span></span>
<span id="cb47-4"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb47-4" tabindex="-1"></a>  <span class="fu">lm</span>(</span>
<span id="cb47-5"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb47-5" tabindex="-1"></a>    <span class="at">formula =</span> vas_crave_opiates_eot <span class="sc">~</span> arm <span class="sc">+</span> vas_crave_opiates_bl,</span>
<span id="cb47-6"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb47-6" tabindex="-1"></a>    <span class="at">data =</span> ctn03_sim_mar</span>
<span id="cb47-7"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb47-7" tabindex="-1"></a>  )</span>
<span id="cb47-8"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb47-8" tabindex="-1"></a></span>
<span id="cb47-9"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb47-9" tabindex="-1"></a><span class="fu">summary</span>(vas_ancova_1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = vas_crave_opiates_eot ~ arm + vas_crave_opiates_bl, 
##     data = ctn03_sim_mar)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -54.193 -21.747  -6.874  15.151  71.637 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          24.05363    2.27269  10.584  &lt; 2e-16 ***
## arm7-day             -2.17932    2.82195  -0.772     0.44    
## vas_crave_opiates_bl  0.35910    0.07595   4.728 3.29e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 25.96 on 350 degrees of freedom
##   (163 observations deleted due to missingness)
## Multiple R-squared:  0.06006,    Adjusted R-squared:  0.05469 
## F-statistic: 11.18 on 2 and 350 DF,  p-value: 1.962e-05</code></pre>
<p>Note that the standard error reported by <code>lm()</code> is the model-based standard error, not a robust standard error or bootstrap standard error.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-1" tabindex="-1"></a><span class="co"># 2. Generate predictions based on fitted model:</span></span>
<span id="cb49-2"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-2" tabindex="-1"></a><span class="co"># Their predicted outcome if they were assigned to treatment (7-day taper)</span></span>
<span id="cb49-3"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-3" tabindex="-1"></a><span class="co"># Their predicted outcome if they were assigned to control (28-day taper)</span></span>
<span id="cb49-4"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-4" tabindex="-1"></a>expected_vas_7_day <span class="ot">&lt;-</span></span>
<span id="cb49-5"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-5" tabindex="-1"></a>  <span class="fu">predict</span>(</span>
<span id="cb49-6"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-6" tabindex="-1"></a>    <span class="at">object =</span> vas_ancova_1,</span>
<span id="cb49-7"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-7" tabindex="-1"></a>    <span class="at">newdata =</span></span>
<span id="cb49-8"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-8" tabindex="-1"></a>      <span class="fu">within</span>(</span>
<span id="cb49-9"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-9" tabindex="-1"></a>        <span class="at">data =</span> ctn03_sim_mar,</span>
<span id="cb49-10"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-10" tabindex="-1"></a>        <span class="at">expr =</span> {arm <span class="ot">=</span> <span class="st">&quot;7-day&quot;</span>}</span>
<span id="cb49-11"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-11" tabindex="-1"></a>      ),</span>
<span id="cb49-12"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-12" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb49-13"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-13" tabindex="-1"></a>  )</span>
<span id="cb49-14"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-14" tabindex="-1"></a></span>
<span id="cb49-15"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-15" tabindex="-1"></a>expected_vas_28_day <span class="ot">&lt;-</span></span>
<span id="cb49-16"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-16" tabindex="-1"></a>  <span class="fu">predict</span>(</span>
<span id="cb49-17"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-17" tabindex="-1"></a>    <span class="at">object =</span> vas_ancova_1,</span>
<span id="cb49-18"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-18" tabindex="-1"></a>    <span class="at">newdata =</span></span>
<span id="cb49-19"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-19" tabindex="-1"></a>      <span class="fu">within</span>(</span>
<span id="cb49-20"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-20" tabindex="-1"></a>        <span class="at">data =</span> ctn03_sim_mar,</span>
<span id="cb49-21"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-21" tabindex="-1"></a>        <span class="at">expr =</span> {arm <span class="ot">=</span> <span class="st">&quot;28-day&quot;</span>}</span>
<span id="cb49-22"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-22" tabindex="-1"></a>      ),</span>
<span id="cb49-23"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-23" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb49-24"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-24" tabindex="-1"></a>  )</span>
<span id="cb49-25"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-25" tabindex="-1"></a></span>
<span id="cb49-26"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-26" tabindex="-1"></a></span>
<span id="cb49-27"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-27" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb49-28"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-28" tabindex="-1"></a>  expected_vas_7_day,</span>
<span id="cb49-29"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-29" tabindex="-1"></a>  expected_vas_28_day,</span>
<span id="cb49-30"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-30" tabindex="-1"></a>  ctn03_sim_mar[, <span class="fu">c</span>(<span class="st">&quot;arm&quot;</span>, <span class="st">&quot;vas_crave_opiates_eot&quot;</span>, <span class="st">&quot;vas_crave_opiates_bl&quot;</span>)]</span>
<span id="cb49-31"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-31" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-32"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb49-32" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##   expected_vas_7_day expected_vas_28_day   arm vas_crave_opiates_eot
## 1           27.97901            30.15833 7-day                    NA
## 2           24.38801            26.56733 7-day                     5
## 3           32.64731            34.82663 7-day                    31
## 4           24.38801            26.56733 7-day                    40
## 5           28.69721            30.87653 7-day                    51
## 6           26.18351            28.36283 7-day                     1
##   vas_crave_opiates_bl
## 1                   17
## 2                    7
## 3                   30
## 4                    7
## 5                   19
## 6                   12</code></pre>
<p>Once we’ve generated these predictions, we can compute the ANCOVA estimate of the average treatment effect:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb51-1" tabindex="-1"></a><span class="fu">mean</span>(expected_vas_7_day)</span></code></pre></div>
<pre><code>## [1] 26.88292</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb53-1" tabindex="-1"></a><span class="fu">mean</span>(expected_vas_28_day)</span></code></pre></div>
<pre><code>## [1] 29.06224</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb55-1" tabindex="-1"></a>vas_ancova_estimate <span class="ot">&lt;-</span> <span class="fu">mean</span>(expected_vas_7_day) <span class="sc">-</span> <span class="fu">mean</span>(expected_vas_28_day)</span>
<span id="cb55-2"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb55-2" tabindex="-1"></a>vas_ancova_estimate</span></code></pre></div>
<pre><code>## [1] -2.179321</code></pre>
<p>Notice this is the exact same as the regression coefficient for <code>arm</code> in the regression model, since there’s no treatment-covariate interactions and an identity link function. We can obtain the standard error of the estimate two ways. The first way is using the <code>margins::margins()</code> command, using the robust standard errors from <code>sandwich::vcovHC</code>:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb57-1" tabindex="-1"></a>vas_ancova_margins <span class="ot">&lt;-</span></span>
<span id="cb57-2"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb57-2" tabindex="-1"></a>  margins<span class="sc">::</span><span class="fu">margins</span>(</span>
<span id="cb57-3"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb57-3" tabindex="-1"></a>    <span class="at">model =</span> vas_ancova_1,</span>
<span id="cb57-4"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb57-4" tabindex="-1"></a>    <span class="co"># Specify treatment variable</span></span>
<span id="cb57-5"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb57-5" tabindex="-1"></a>    <span class="at">variables =</span> <span class="st">&quot;arm&quot;</span>,</span>
<span id="cb57-6"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb57-6" tabindex="-1"></a>    <span class="co"># Convert to outcome scale, not link scale</span></span>
<span id="cb57-7"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb57-7" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;response&quot;</span>,</span>
<span id="cb57-8"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb57-8" tabindex="-1"></a>    <span class="co"># Obtain robust standard errors</span></span>
<span id="cb57-9"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb57-9" tabindex="-1"></a>    <span class="at">vcov =</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(<span class="at">x =</span> vas_ancova_1, <span class="at">type =</span> <span class="st">&quot;HC3&quot;</span>)</span>
<span id="cb57-10"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb57-10" tabindex="-1"></a>  )</span>
<span id="cb57-11"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb57-11" tabindex="-1"></a></span>
<span id="cb57-12"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb57-12" tabindex="-1"></a><span class="fu">summary</span>(<span class="at">object =</span> vas_ancova_margins, <span class="at">level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##    factor     AME     SE       z      p   lower  upper
##  arm7-day -2.1793 2.8680 -0.7599 0.4473 -7.8005 3.4418</code></pre>
<p>You’ll see that we now have a standard error, p-value under the hypothesis that the marginal effect is 0, and a 95% Confidence Interval for the estimate. Another way to obtain these is the bias corrected and accelerated (BCa) non-parametric bootstrap:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-1" tabindex="-1"></a><span class="co"># Write a function to produce the ANCOVA estimate</span></span>
<span id="cb59-2"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-2" tabindex="-1"></a>margins_fun <span class="ot">&lt;-</span></span>
<span id="cb59-3"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-3" tabindex="-1"></a>  <span class="cf">function</span>(data, <span class="at">indices =</span> <span class="cn">NULL</span>, formula, family, term){</span>
<span id="cb59-4"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-4" tabindex="-1"></a>    <span class="co"># Input data must be a data.frame</span></span>
<span id="cb59-5"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-5" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">all</span>(<span class="fu">class</span>(data) <span class="sc">==</span> <span class="st">&quot;data.frame&quot;</span>)){</span>
<span id="cb59-6"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-6" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;`data` must be a data.frame: use `as.data.frame()` for a tibble.&quot;</span>)</span>
<span id="cb59-7"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-7" tabindex="-1"></a>    }</span>
<span id="cb59-8"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-8" tabindex="-1"></a>    </span>
<span id="cb59-9"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-9" tabindex="-1"></a>    <span class="co"># If bootstrap indices not supplied, use entire dataset</span></span>
<span id="cb59-10"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-10" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(indices)) indices <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data)</span>
<span id="cb59-11"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-11" tabindex="-1"></a>    </span>
<span id="cb59-12"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-12" tabindex="-1"></a>    data <span class="ot">&lt;-</span> data[indices,]</span>
<span id="cb59-13"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-13" tabindex="-1"></a>    </span>
<span id="cb59-14"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-14" tabindex="-1"></a>    glm_fit <span class="ot">&lt;-</span></span>
<span id="cb59-15"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-15" tabindex="-1"></a>      <span class="fu">glm</span>(</span>
<span id="cb59-16"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-16" tabindex="-1"></a>        <span class="at">formula =</span> formula,</span>
<span id="cb59-17"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-17" tabindex="-1"></a>        <span class="at">family =</span> family,</span>
<span id="cb59-18"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-18" tabindex="-1"></a>        <span class="at">data =</span> data</span>
<span id="cb59-19"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-19" tabindex="-1"></a>      )</span>
<span id="cb59-20"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-20" tabindex="-1"></a>    </span>
<span id="cb59-21"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-21" tabindex="-1"></a>    tx_levels <span class="ot">&lt;-</span> <span class="fu">levels</span>(data[, term])</span>
<span id="cb59-22"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-22" tabindex="-1"></a>    </span>
<span id="cb59-23"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-23" tabindex="-1"></a>    e_y_1 <span class="ot">&lt;-</span></span>
<span id="cb59-24"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-24" tabindex="-1"></a>      <span class="fu">predict</span>(</span>
<span id="cb59-25"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-25" tabindex="-1"></a>        <span class="at">object =</span> glm_fit,</span>
<span id="cb59-26"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-26" tabindex="-1"></a>        <span class="at">newdata =</span> </span>
<span id="cb59-27"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-27" tabindex="-1"></a>          <span class="fu">within</span>(</span>
<span id="cb59-28"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-28" tabindex="-1"></a>            data,</span>
<span id="cb59-29"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-29" tabindex="-1"></a>            <span class="at">expr =</span> <span class="fu">assign</span>(<span class="at">x =</span> term, <span class="at">value =</span> tx_levels[<span class="dv">2</span>])</span>
<span id="cb59-30"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-30" tabindex="-1"></a>          ),</span>
<span id="cb59-31"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-31" tabindex="-1"></a>        </span>
<span id="cb59-32"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-32" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb59-33"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-33" tabindex="-1"></a>      )</span>
<span id="cb59-34"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-34" tabindex="-1"></a>    </span>
<span id="cb59-35"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-35" tabindex="-1"></a>    e_y_0 <span class="ot">&lt;-</span></span>
<span id="cb59-36"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-36" tabindex="-1"></a>      <span class="fu">predict</span>(</span>
<span id="cb59-37"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-37" tabindex="-1"></a>        <span class="at">object =</span> glm_fit,</span>
<span id="cb59-38"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-38" tabindex="-1"></a>        <span class="at">newdata =</span> </span>
<span id="cb59-39"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-39" tabindex="-1"></a>          <span class="fu">within</span>(</span>
<span id="cb59-40"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-40" tabindex="-1"></a>            data,</span>
<span id="cb59-41"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-41" tabindex="-1"></a>            <span class="at">expr =</span> <span class="fu">assign</span>(<span class="at">x =</span> term, <span class="at">value =</span> tx_levels[<span class="dv">1</span>])</span>
<span id="cb59-42"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-42" tabindex="-1"></a>          ),</span>
<span id="cb59-43"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-43" tabindex="-1"></a>        </span>
<span id="cb59-44"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-44" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb59-45"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-45" tabindex="-1"></a>      )</span>
<span id="cb59-46"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-46" tabindex="-1"></a>    </span>
<span id="cb59-47"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-47" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mean</span>(e_y_1) <span class="sc">-</span> <span class="fu">mean</span>(e_y_0))</span>
<span id="cb59-48"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-48" tabindex="-1"></a>  }</span>
<span id="cb59-49"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-49" tabindex="-1"></a></span>
<span id="cb59-50"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-50" tabindex="-1"></a>vas_ancova_boot <span class="ot">&lt;-</span></span>
<span id="cb59-51"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-51" tabindex="-1"></a>  boot<span class="sc">::</span><span class="fu">boot</span>(</span>
<span id="cb59-52"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-52" tabindex="-1"></a>    <span class="at">data =</span> ctn03_sim_mar,</span>
<span id="cb59-53"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-53" tabindex="-1"></a>    <span class="at">statistic =</span> margins_fun,</span>
<span id="cb59-54"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-54" tabindex="-1"></a>    <span class="at">R =</span> <span class="dv">10000</span>,</span>
<span id="cb59-55"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-55" tabindex="-1"></a>      <span class="at">formula =</span> vas_crave_opiates_eot <span class="sc">~</span> arm <span class="sc">+</span> vas_crave_opiates_bl,</span>
<span id="cb59-56"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-56" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">&quot;identity&quot;</span>),</span>
<span id="cb59-57"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-57" tabindex="-1"></a>    <span class="at">term =</span> <span class="st">&quot;arm&quot;</span></span>
<span id="cb59-58"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-58" tabindex="-1"></a>  )</span>
<span id="cb59-59"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-59" tabindex="-1"></a></span>
<span id="cb59-60"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb59-60" tabindex="-1"></a>vas_ancova_boot</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot::boot(data = ctn03_sim_mar, statistic = margins_fun, R = 10000, 
##     formula = vas_crave_opiates_eot ~ arm + vas_crave_opiates_bl, 
##     family = gaussian(link = &quot;identity&quot;), term = &quot;arm&quot;)
## 
## 
## Bootstrap Statistics :
##      original    bias    std. error
## t1* -2.179321 0.0631477    2.816499</code></pre>
<p>We can extract the standard error and produce a 95% confidence interval:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb61-1" tabindex="-1"></a><span class="co"># Bootstrap Standard Error</span></span>
<span id="cb61-2"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb61-2" tabindex="-1"></a><span class="fu">sd</span>(vas_ancova_boot<span class="sc">$</span>t[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 2.816499</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb63-1" tabindex="-1"></a>vas_ancova_boot_ci <span class="ot">&lt;-</span></span>
<span id="cb63-2"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb63-2" tabindex="-1"></a>  boot<span class="sc">::</span><span class="fu">boot.ci</span>(</span>
<span id="cb63-3"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb63-3" tabindex="-1"></a>    <span class="at">boot.out =</span> vas_ancova_boot,</span>
<span id="cb63-4"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb63-4" tabindex="-1"></a>    <span class="at">conf =</span> <span class="fl">0.95</span>,</span>
<span id="cb63-5"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb63-5" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;bca&quot;</span></span>
<span id="cb63-6"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb63-6" tabindex="-1"></a>  )</span>
<span id="cb63-7"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb63-7" tabindex="-1"></a></span>
<span id="cb63-8"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb63-8" tabindex="-1"></a>vas_ancova_boot_ci</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 10000 bootstrap replicates
## 
## CALL : 
## boot::boot.ci(boot.out = vas_ancova_boot, conf = 0.95, type = &quot;bca&quot;)
## 
## Intervals : 
## Level       BCa          
## 95%   (-7.673,  3.237 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>We can compare these to the results from <code>margins::margins()</code>:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb65-1" tabindex="-1"></a><span class="co"># Margins SE</span></span>
<span id="cb65-2"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb65-2" tabindex="-1"></a>ancova_margins_se <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="at">object =</span> vas_ancova_margins, <span class="at">level =</span> <span class="fl">0.95</span>)<span class="sc">$</span>SE</span>
<span id="cb65-3"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb65-3" tabindex="-1"></a>ancova_margins_se</span></code></pre></div>
<pre><code>## [1] 2.867989</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb67-1" tabindex="-1"></a><span class="co"># Bootstrap SE</span></span>
<span id="cb67-2"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb67-2" tabindex="-1"></a>ancova_boot_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(vas_ancova_boot<span class="sc">$</span>t[,<span class="dv">1</span>])</span>
<span id="cb67-3"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb67-3" tabindex="-1"></a>ancova_boot_se</span></code></pre></div>
<pre><code>## [1] 2.816499</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb69-1" tabindex="-1"></a><span class="co"># Compare as ratio</span></span>
<span id="cb69-2"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb69-2" tabindex="-1"></a>ancova_margins_se<span class="sc">/</span>ancova_boot_se</span></code></pre></div>
<pre><code>## [1] 1.018282</code></pre>
<p>The standard errors are nearly identical using the estimated marginal effect with robust standard errors or the bootstrap.</p>
<hr />
<div id="calculating-precision-gain" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Calculating Precision Gain<a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#calculating-precision-gain" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Asymptotically, the ANCOVA estimate should have precision that is equal or better than an unadjusted analysis. We can calculate the precision gain by taking the ratio of the variances, i.e. the squared standard errors, of the adjusted estimator to the unadjusted estimator.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb71-1" tabindex="-1"></a>vas_t_test <span class="ot">&lt;-</span></span>
<span id="cb71-2"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb71-2" tabindex="-1"></a>  <span class="fu">t.test</span>(</span>
<span id="cb71-3"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb71-3" tabindex="-1"></a>    <span class="at">formula =</span> vas_crave_opiates_eot <span class="sc">~</span> arm,</span>
<span id="cb71-4"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb71-4" tabindex="-1"></a>    <span class="at">data =</span> ctn03_sim_mar,</span>
<span id="cb71-5"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb71-5" tabindex="-1"></a>    <span class="at">var.equal =</span> <span class="cn">FALSE</span></span>
<span id="cb71-6"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb71-6" tabindex="-1"></a>  )</span>
<span id="cb71-7"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb71-7" tabindex="-1"></a></span>
<span id="cb71-8"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb71-8" tabindex="-1"></a>vas_t_test</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  vas_crave_opiates_eot by arm
## t = 0.093598, df = 316.77, p-value = 0.9255
## alternative hypothesis: true difference in means between group 28-day and group 7-day is not equal to 0
## 95 percent confidence interval:
##  -5.418971  5.960313
## sample estimates:
## mean in group 28-day  mean in group 7-day 
##             28.01325             27.74257</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb73-1" tabindex="-1"></a><span class="co"># Get unadjusted standard error</span></span>
<span id="cb73-2"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb73-2" tabindex="-1"></a>t_test_se <span class="ot">&lt;-</span> vas_t_test<span class="sc">$</span>stderr</span>
<span id="cb73-3"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb73-3" tabindex="-1"></a>t_test_se</span></code></pre></div>
<pre><code>## [1] 2.891841</code></pre>
<p>The precision gain is equal to the ratio of the variance, which is the square of the standard error:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb75-1" tabindex="-1"></a><span class="co"># Percentage reduction in variance adjusting for baseline outcome</span></span>
<span id="cb75-2"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb75-2" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> (ancova_margins_se<span class="sc">/</span>t_test_se)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 1.642819</code></pre>
<p>The precision gain in this particular example is rather small, but we have only adjusted for one potential covariate. However, there are several other baseline variables we did not include in the model. We can see if the gain in precision is larger when these other variables are included. We should also include the stability dose in the outcome, since randomization was stratified by this variable:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-1" tabindex="-1"></a>vas_ancova_2 <span class="ot">&lt;-</span></span>
<span id="cb77-2"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-2" tabindex="-1"></a>  <span class="fu">glm</span>(</span>
<span id="cb77-3"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-3" tabindex="-1"></a>    <span class="at">formula =</span> vas_crave_opiates_eot <span class="sc">~</span> </span>
<span id="cb77-4"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-4" tabindex="-1"></a>      arm <span class="sc">+</span> vas_crave_opiates_bl <span class="sc">+</span> stability_dose <span class="sc">+</span></span>
<span id="cb77-5"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-5" tabindex="-1"></a>      arsw_score_bl <span class="sc">+</span> cows_total_score_bl <span class="sc">+</span></span>
<span id="cb77-6"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-6" tabindex="-1"></a>      vas_current_withdrawal_bl <span class="sc">+</span> vas_study_tx_help_bl <span class="sc">+</span> uds_any_positive_bl,</span>
<span id="cb77-7"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-7" tabindex="-1"></a>    <span class="at">data =</span> ctn03_sim_mar</span>
<span id="cb77-8"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-8" tabindex="-1"></a>  )</span>
<span id="cb77-9"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-9" tabindex="-1"></a></span>
<span id="cb77-10"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-10" tabindex="-1"></a>vas_ancova_margins_2 <span class="ot">&lt;-</span></span>
<span id="cb77-11"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-11" tabindex="-1"></a>  margins<span class="sc">::</span><span class="fu">margins</span>(</span>
<span id="cb77-12"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-12" tabindex="-1"></a>    <span class="at">model =</span> vas_ancova_2,</span>
<span id="cb77-13"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-13" tabindex="-1"></a>    <span class="co"># Specify treatment variable</span></span>
<span id="cb77-14"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-14" tabindex="-1"></a>    <span class="at">variables =</span> <span class="st">&quot;arm&quot;</span>,</span>
<span id="cb77-15"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-15" tabindex="-1"></a>    <span class="co"># Convert to outcome scale, not link scale</span></span>
<span id="cb77-16"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-16" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;response&quot;</span>,</span>
<span id="cb77-17"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-17" tabindex="-1"></a>    <span class="co"># Obtain robust standard errors</span></span>
<span id="cb77-18"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-18" tabindex="-1"></a>    <span class="at">vcov =</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(<span class="at">x =</span> vas_ancova_2, <span class="at">type =</span> <span class="st">&quot;HC3&quot;</span>)</span>
<span id="cb77-19"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-19" tabindex="-1"></a>  )</span>
<span id="cb77-20"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-20" tabindex="-1"></a></span>
<span id="cb77-21"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-21" tabindex="-1"></a>ancova_margins_2_se <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="at">object =</span> vas_ancova_margins_2, <span class="at">level =</span> <span class="fl">0.95</span>)<span class="sc">$</span>SE</span>
<span id="cb77-22"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-22" tabindex="-1"></a></span>
<span id="cb77-23"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-23" tabindex="-1"></a><span class="co"># Percentage reduction in variance adjusting for baseline outcome</span></span>
<span id="cb77-24"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb77-24" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> (ancova_margins_2_se<span class="sc">/</span>t_test_se)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 7.590248</code></pre>
<p>Including these other covariates leads to a larger gain in precision.</p>
<hr />
</div>
<div id="missing-outcome-data-inverse-weighting" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Missing Outcome Data: Inverse Weighting<a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#missing-outcome-data-inverse-weighting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far, we have not discussed the issue of missing outcome data. While the G-computation estimator is robust to arbitrary model misspecification, it is only valid if data are missing completely at random (MCAR): missingness is unrelated to either the observed or unobserved data. If this were the case, we should not see any association between the baseline covariates and missingness in the VAS opiate craving scores at the end-of-taper visit. We can assess this using a generalized additive model (GAM):</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb79-1" tabindex="-1"></a>vas_mar_glm <span class="ot">&lt;-</span></span>
<span id="cb79-2"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb79-2" tabindex="-1"></a>  mgcv<span class="sc">::</span><span class="fu">gam</span>(</span>
<span id="cb79-3"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb79-3" tabindex="-1"></a>    <span class="at">formula =</span> </span>
<span id="cb79-4"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb79-4" tabindex="-1"></a>      <span class="fu">is.na</span>(vas_crave_opiates_eot) <span class="sc">~</span></span>
<span id="cb79-5"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb79-5" tabindex="-1"></a>      arm <span class="sc">+</span> stability_dose <span class="sc">+</span></span>
<span id="cb79-6"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb79-6" tabindex="-1"></a>      <span class="fu">s</span>(age) <span class="sc">+</span> sex <span class="sc">+</span></span>
<span id="cb79-7"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb79-7" tabindex="-1"></a>      <span class="fu">s</span>(vas_crave_opiates_bl) <span class="sc">+</span> <span class="fu">s</span>(arsw_score_bl) <span class="sc">+</span> <span class="fu">s</span>(cows_total_score_bl) <span class="sc">+</span></span>
<span id="cb79-8"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb79-8" tabindex="-1"></a>      <span class="fu">s</span>(vas_current_withdrawal_bl) <span class="sc">+</span> <span class="fu">s</span>(vas_study_tx_help_bl) <span class="sc">+</span></span>
<span id="cb79-9"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb79-9" tabindex="-1"></a>      uds_any_positive_bl,</span>
<span id="cb79-10"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb79-10" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>),</span>
<span id="cb79-11"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb79-11" tabindex="-1"></a>    <span class="at">data =</span> ctn03_sim_mar</span>
<span id="cb79-12"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb79-12" tabindex="-1"></a>  )</span>
<span id="cb79-13"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb79-13" tabindex="-1"></a></span>
<span id="cb79-14"><a href="applying-covariate-adjustment-ancova-g-computation-dr-wls.html#cb79-14" tabindex="-1"></a><span class="fu">summary</span>(vas_mar_glm)</span></code></pre></div>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## is.na(vas_crave_opiates_eot) ~ arm + stability_dose + s(age) + 
##     sex + s(vas_crave_opiates_bl) + s(arsw_score_bl) + s(cows_total_score_bl) + 
##     s(vas_current_withdrawal_bl) + s(vas_study_tx_help_bl) + 
##     uds_any_positive_bl
## 
## Parametric coefficients:
##                             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                 -1.80921    0.56096  -3.225  0.00126 ** 
## arm7-day                    -1.01189    0.20978  -4.824 1.41e-06 ***
## stability_dose16 mg          1.74449    0.57581   3.030  0.00245 ** 
## stability_dose24 mg          1.46083    0.56381   2.591  0.00957 ** 
## sexFemale                    0.11516    0.22339   0.516  0.60620    
## uds_any_positive_blPositive -0.07541    0.21609  -0.349  0.72711    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                                edf Ref.df Chi.sq p-value   
## s(age)                       1.758  2.210  1.947  0.4526   
## s(vas_crave_opiates_bl)      1.000  1.000  1.436  0.2308   
## s(arsw_score_bl)             1.000  1.000  7.327  0.0068 **
## s(cows_total_score_bl)       3.110  3.839  6.372  0.1944   
## s(vas_current_withdrawal_bl) 2.120  2.692  7.016  0.0561 . 
## s(vas_study_tx_help_bl)      1.000  1.000  1.542  0.2143   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.0853   Deviance explained = 9.61%
## UBRE = 0.18961  Scale est. = 1         n = 516</code></pre>
<p>The GAM model shows that, all other things being equal, missingness was lower in the 7-day arm, higher in individuals on 16 or 24 mg stability doses, and was associated with some of the baseline outcome measures. In the next section, we will discuss methods that can be robust to model misspecification and do not require the MCAR assumption.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="using_r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="doublyrobust.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/covariateadjustment/covariateadjustment.github.io/edit/main/04-Standardization.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
